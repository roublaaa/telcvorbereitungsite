
<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Lesen Teil 1 - Geld</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* ========================================= */
    /*        1. PROFESSIONAL CSS VARIABLES      */
    /* ========================================= */
    :root {
      /* Palette: Professional Indigo & Slate */
      --primary: #1e293b;       /* Indigo */
      --primary-soft: #e0e7ff;
      --bg-body: #f8fafc;       /* Slate-50 */
      --surface: #ffffff;
      
      --text-main: #1e293b;     /* Slate-800 */
      
      --success: #10b981;       /* Emerald */
      --success-bg: #d1fae5;
      --error: #ef4444;         /* Red */
      --error-bg: #fee2e2;

      /* Dimensions & Spacing */
      --radius: 12px;
      --shadow-sm: 0 1px 3px rgba(0,0,0,0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      
      /* FIXED DIMENSIONS */
      --header-height: 60px;
      --mobile-answer-height: 140px; /* INCREASED height for long text */
    }

    *, *::before, *::after { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

    body {
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      margin: 0; padding: 0;
      background-color: var(--bg-body);
      color: var(--text-main);
      min-height: 100vh;
      line-height: 1.5;
    }

    /* ========================================= */
    /*           2. HEADER (FIXED)               */
    /* ========================================= */
    .main-header {
      position: fixed;
      top: 0; left: 0; width: 100%;
      height: var(--header-height);
      
      background: var(--primary); /* Opaque enough to hide scroll */
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      
      border-bottom: 1px solid rgba(0,0,0,0.05);
      color: var(--surface);
      z-index: 2000; /* Highest Layer */
      
      display: flex; align-items: center; justify-content: center;
      font-weight: 800; font-size: 1.1rem;
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    }

    /* ========================================= */
    /*           3. LAYOUT CONTAINER             */
    /* ========================================= */
    .container {
      max-width: 1280px;
      margin: 0 auto;
      
      /* Dynamic Top Padding: Header + Spacing */
      padding-top: calc(var(--header-height) + 40px);
      padding-bottom: 60px;
      padding-left: 24px; padding-right: 24px;
      
      display: flex;
      gap: 40px;
      align-items: flex-start;
    }

    /* ========================================= */
    /*        4. LEFT COLUMN (QUESTIONS)         */
    /* ========================================= */
    .left-column {
      width: 60%;
      flex-shrink: 0;
    }

    .question-box {
      background: var(--surface);
      border-radius: var(--radius);
      padding: 30px;
      margin-bottom: 24px;
      box-shadow: var(--shadow-sm);
      border: 1px solid #e2e8f0;
    }

    .question-text {
      font-size: 1rem;
      color: #334155;
      margin-top: 20px;
    }

    /* DROP ZONES */
    .email-fields { margin-bottom: 15px; }

    .drop-target {
      background-color: #f1f5f9;
      border: 2px dashed #cbd5e1;
      border-radius: 12px;
      min-height: 64px;
      display: flex; align-items: center; justify-content: center;
      transition: all 0.2s ease;
      cursor: pointer;
      position: relative;
    }

    .drop-target.empty-drop-target::before {
      content: "Hier Antwort ablegen";
      color: #94a3b8; font-size: 0.9rem; font-weight: 600;
      pointer-events: none;
    }

    .drop-target.drag-over {
      background-color: var(--primary-soft);
      border-color: var(--primary);
      transform: scale(1.01);
    }

    /* DROPPED ITEMS (Inside Question) */
    .drop-target .draggable {
      border: none; background: transparent; padding: 5px; text-align: center;
      color: var(--primary); width: 100%; box-shadow: none;
      font-weight: 700; margin: 0; font-size: 0.95rem;
      height: auto; /* Allow auto height when dropped */
    }

    /* ========================================= */
    /*        5. RIGHT COLUMN (ANSWERS)          */
    /* ========================================= */
    .right-column {
      width: 35%;
      
      /* STICKY SIDEBAR (Desktop) */
      position: sticky; 
      top: calc(var(--header-height) + 30px); 
      height: calc(100vh - 120px);
      z-index: 1000;
    }

    .right-column-content {
      background: var(--surface);
      padding: 20px;
      border-radius: var(--radius);
      box-shadow: var(--shadow-md);
      border: 1px solid rgba(0,0,0,0.03);
      max-height: 100%;
      overflow-y: auto;
    }

    /* DRAGGABLE CARDS */
    .draggable {
      background: white;
      border: 1px solid #e2e8f0;
      border-left: 4px solid var(--primary);
      padding: 14px 18px;
      margin-bottom: 12px;
      border-radius: 10px;
      cursor: grab;
      font-size: 0.9rem; font-weight: 500; color: #334155;
      box-shadow: 0 1px 2px rgba(0,0,0,0.04);
      transition: all 0.2s;
      user-select: none;
    }

    .draggable.selected {
      background-color: var(--primary);
      color: white;
      border-color: var(--primary);
    }

    /* ========================================= */
    /*        6. FEEDBACK & BUTTONS              */
    /* ========================================= */
    .drop-target.correct { background: var(--success-bg) !important; border-color: var(--success) !important; }
    .drop-target.correct .draggable { color: #065f46 !important; }
    .drop-target.correct::after { content: "‚úì"; position: absolute; right: 15px; color: var(--success); font-weight: bold; }
    
    .drop-target.incorrect { background: var(--error-bg) !important; border-color: var(--error) !important; }
    .drop-target.incorrect .draggable { color: #991b1b !important; }
    .drop-target.incorrect::after { content: "‚úï"; position: absolute; right: 15px; color: var(--error); font-weight: bold; }

    /* Buttons */
    .button-container { display: flex; justify-content: center; gap: 15px; margin-top: 20px; margin-bottom: 40px; }
    
    .quiz-button, .quiz-button-link {
      background: var(--text-main); color: white !important;
      padding: 14px 32px; border-radius: 50px;
      font-weight: 600; border: none; text-decoration: none; cursor: pointer;
      display: flex; align-items: center; gap: 10px; font-size: 1rem;
      transition: all 0.2s;
      box-shadow: var(--shadow-md);
    }
    
    .quiz-button.secondary, .quiz-button-link.secondary {
      background: white; color: var(--text-main) !important;
      border: 1px solid #cbd5e1;
    }
    
    #result { text-align: center; margin-bottom: 25px; font-weight: 800; font-size: 1.25rem; }
    #result .correct-count { color: var(--success); }
    #result .total-count { color: var(--text-main); }


    /* ========================================= */
    /*           7. MOBILE RESPONSIVE            */
    /* ========================================= */

    @media (max-width: 991px) {
      
      /* 1. Header Adjustment */
      .main-header {
        font-size: 1rem;
        height: var(--header-height);
        padding: 0 10px;
      }

      /* 2. Layout: Stacked */
      .container {
        flex-direction: column;
        padding: 0;
        /* Calculate Top Padding: Header + AnswerBar + Extra Gap */
        padding-top: calc(var(--header-height) + var(--mobile-answer-height) + 20px);
      }

      /* 3. ANSWER BAR (FIXED HORIZONTAL SCROLL) */
      .right-column {
        position: fixed;
        top: var(--header-height); /* Starts immediately after header */
        left: 0; width: 100%;
        height: var(--mobile-answer-height);
        z-index: 1500;
        
        background: #f1f5f9; /* Solid background to hide content behind */
        border-bottom: 1px solid rgba(0,0,0,0.1);
        box-shadow: 0 4px 10px -2px rgba(0,0,0,0.05);
      }

      .right-column-content {
        display: flex; 
        flex-direction: row; 
        gap: 12px;
        
        /* Add padding inside the scroll area so cards don't touch edges */
        padding: 15px 16px; 
        
        height: 100%;
        width: 100%;
        background: transparent;
        border: none; box-shadow: none; border-radius: 0;
        
        /* Horizontal Scroll */
        overflow-x: auto; 
        overflow-y: hidden;
        white-space: normal; /* Changed from nowrap to normal to allow wrapping inside card */
        scroll-snap-type: x mandatory;
        
        align-items: flex-start; /* Align top */
      }
      
      /* Hide Scrollbar */
      .right-column-content::-webkit-scrollbar { display: none; }

      /* 4. Mobile Answer Cards */
      .draggable {
        flex: 0 0 auto; /* Don't shrink */
        width: 190px;   /* Fixed width */
        height: 100%;   /* Fill height of the container */
        margin: 0;
        
        display: flex; 
        align-items: center; 
        justify-content: center;
        text-align: center;
        
        font-size: 0.8rem;
        line-height: 1.3;
        scroll-snap-align: center;
        
        background: white;
        border: 1px solid #e2e8f0;
        border-bottom: 4px solid var(--primary); /* Accent at bottom for mobile */
        border-left: 1px solid #e2e8f0; /* Reset desktop left border */
        
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      }
      
      .draggable.selected {
        background: var(--primary);
        color: white;
        border: none;
      }

      /* 5. Left Column (Questions) */
      .left-column { width: 100%; padding: 0 16px; }
      .question-box { padding: 20px; border-radius: 12px; }

      /* 6. Buttons */
      .button-container { flex-direction: column; padding: 0 16px 0 16px; gap: 12px; margin-top: 20px; }
      .quiz-button, .quiz-button-link { width: 100%; justify-content: center; padding: 16px; }
    }
  </style>
</head>
<body>

<div class="main-header">Lesen Teil 1 - Geld</div>

<div class="container">
  <div class="left-column">
    <div class="quiz-scroll-container">
      <!-- Question 1 -->
      <div class="question-box" data-correct="Sammelgef√§√üe als Ausstellungsobjekte.">
          <div class="email-fields">
            <div class="email-subject drop-target empty-drop-target" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
          </div>
          <div class="question-text">
        Spardosen sind Sammelbeh√§lter, Dekoration oder Kinderspielzeug - und zwar seit Jahrhunderten. Und obwohl bargeldloses Bezahlen immer mehr in Mode kommt, sind sie bis heute nicht aus den Kinderzimmern verschwunden. Das Spardosen-Museum im Haus Kemnade zeigt 1200 Exemplare aus dem Mittelalter bis zum 20. Jahrhundert. Daneben widmet sich das Museum der Geschichte des Geldes. In zwei R√§umen sind M√ºnzen, Scheine und weitere Tauschmittel aus der ganzen Welt ausgestellt. Die Sammlung von Spardosen reicht von schweren Gef√§√üen aus Eisen √ºber kunstvoll verzierte Truhen und Kutschen bis zu Mickey-M√§usen aus Blech. "Um 1900 erlebten Spardosen einen Boom", erz√§hlt Museumsleiter J√ºrgen Stollmann. In vielen H√§usern hatten sie zwar nur als h√ºbsche Dekoration hergehalten, doch immer seien sie auch ein Spiegel der Gesellschaft. Zehn Jahre sp√§ter schon gibt es das Museum, das interessante Einblicke in die Geldgeschichte bietet. J√§hrlich lockt es √ºber 13.000 Besucher an.
          </div>
      </div>
      <!-- Question 2 -->
      <div class="question-box" data-correct="Lehrreicher Rundgang zu Finanzwissen.">
          <div class="email-fields">
            <div class="email-subject drop-target empty-drop-target" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
          </div>
          <div class="question-text">
        Wer beim leisen Klirren von Geldst√ºcken ein prickelndes Gef√ºhl versp√ºrt, ist in der neuen Sonderausstellung "Die Sprache des Geldes" im Berliner Museum f√ºr Kommunikation richtig. Auf ungew√∂hnliche Weise n√§hert sich diese kleine Schau dem Geld als Dreh- und Angelpunkt einer globalisierten Welt. Im Museum machen die Besucher auf 450 Quadratmetern eine Tour durch eine fiktive Stadt: Auf dem "Marktplatz" erfahren sie, warum sich zuerst M√ºnzen und viel sp√§ter Scheine als Zahlungsmittel durchsetzen. Bei den Stationen "Bank" und "B√∂rse" lernen sie das Prinzip kennen, das in guten Zeiten dahintersteht: Vertrauen in den Wert des Geldes. In der Station "Einkaufszentrum" geht es dagegen um die heutige Konsumgesellschaft. Entlohnt werden die Besucher f√ºr ihren Ausstellungsbesuch nat√ºrlich auch. Wer sein neues Wissen in einem Computerquiz nachweisen kann, erh√§lt einen Spielgeld-Schein mit dem eigenen Konterfei. Macht Geld denn nun gl√ºcklich? "Nur f√ºr einen kurzen Moment", versichert Kurator Gregor Isenbrot. "Wenn der Rausch vorbei ist, will der Mensch noch mehr. Und zwar mehr Geld".
        </div>
      </div>
      <!-- Question 3 -->
      <div class="question-box" data-correct="Finanz-ABC f√ºr Anf√§nger.">
          <div class="email-fields">
            <div class="email-subject drop-target empty-drop-target" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
          </div>
          <div class="question-text">
        "Versteh' ich ja doch nicht; ist mir zu kompliziert". So oder √§hnlich lauten die √ºblichen Vorbehalte, wenn es darum geht, zu begreifen, wie Wirtschaft funktioniert und der Finanzsektor arbeitet. Der englische Journalist John Lanchester nimmt alle jene neugierigen Laien, denen die Fachsprache rund ums Geld bislang verwirrend erschien, bei der Hand. So schildert er in seinem Buch "Die Sprache des Geldes und warum wir sie nicht verstehen", wie er sich als Au√üenseiter dem Thema gen√§hert hat. Geld habe eine eigene Sprache, erkl√§rt Lanchester. Wer diese nicht lerne, k√∂nne nicht mitreden. Und so erl√§utert er im ersten Teil seines Buches die Besonderheiten dieser Sprache. Den zweiten Teil bildet ein alphabetisches Glossar, in dem Fachw√∂rter und Namen in kurzen Artikeln erl√§utert werden. Anschaulich erkl√§rt Lanchester etwa, was Derivate sind und wie man antizyklisch handelt. Das Buch ist anekdotenreich und gut lesbar, seine Lekt√ºre zu empfehlen. Denn Lanchester erm√∂glicht es dem interessierten Wirtschaftslaien, mitreden zu k√∂nnen.
        </div>
      </div>
      <!-- Question 4 -->
      <div class="question-box" data-correct="Vertrauen zeigt sich auf dem Konto.">
          <div class="email-fields">
            <div class="email-subject drop-target empty-drop-target" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
          </div>
          <div class="question-text">
        Eine neue Untersuchung des Instituts der deutschen Wirtschaft best√§tigt eine Tatsache, √ºber die sich Sozialwissenschaftler und Psychologen schon lange einig sind: Die H√∂he des Einkommens allein macht nicht gl√ºcklich. Wie zufrieden ein Arbeitnehmer ist, h√§ngt demnach nicht in erster Linie vom Lohn oder der T√§tigkeit ab, sondern davon, wie emotional stabil, belastbar und selbstsicher er ist. F√ºr die Studie hat die √ñkonomin Mara Ewers die Zusammenh√§nge zwischen der Lebens- und Arbeitszufriedenheit, dem Bruttostundenlohn, der Anzahl der Bildungsjahre und dem Gesundheitszustand untersucht. Sie fand heraus, dass 53 Prozent der Bundesb√ºrger, die sich emotional als besonders stabil bezeichnen, auch im Job sehr zufrieden sind. Die F√§higkeit, anderen Menschen zu vertrauen, steigere die Lebens- und Arbeitszufriedenheit. Die Untersuchung lege die These nahe, dass Einkommensunterschiede auch eine Folge der Pers√∂nlichkeitsentwicklung sein k√∂nnen, so Ewers. Wer misstrauisch sei, verwende mehr Zeit und Kraft f√ºr Kontrollen und sei daher weniger produktiv, sagt sie. Und wer weniger produktiv sei, verdiene auf Dauer auch weniger.
        </div>
      </div>
      <!-- Question 5 -->
      <div class="question-box" data-correct="Wie Kinder den Umgang mit Geld lernen.">
          <div class="email-fields">
            <div class="email-subject drop-target empty-drop-target" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
          </div>
          <div class="question-text">
        √úber Geld sprechen viele Deutsche nicht gerne - selbst Verwandte oder Lebenspartner haben oft keine Ahnung, was sich auf den Konten ihrer N√§chsten tut. Dabei spielt Geld bei den meisten Entscheidungen eine wichtige Rolle, und zwar auch in der Familie. Es ist heutzutage zum Gl√ºck √ºblich, dass Kinder spielerisch ein Gef√ºhl f√ºr Geld entwickeln: Zwei Drittel der Vier- bis F√ºnfj√§hrigen bekommen mittlerweile Taschengeld. Doch die Offenheit von Eltern sollte noch weiter gehen: Denn die Erziehung pr√§gt entscheidend das sp√§tere Verh√§ltnis der Kinder zu Geld, wie Studien belegen. Vorteilhaftes Finanzverhalten nennen Forscher das und setzen es mit der F√§higkeit gleich, Geld sinnvoll einzuteilen oder zu sparen. Nat√ºrlich ist das Thema Geld f√ºr Eltern ein Balanceakt. Doch letztlich lohnt sich der Mut zu Vertrauen und wohldosierter Offenheit, denn wo Offenheit herrscht, kann Verst√§ndnis wachsen. Vielleicht sieht dann auch ein Elfj√§hriger ein, dass die Spielekonsole f√ºr viele hundert Euro zwar toll, aber trotzdem nicht n√∂tig ist.</div>
      </div>
    </div>
  </div>

  <div class="right-column">
    <div class="right-column-content" ondrop="drop(event)" ondragover="allowDrop(event)">
      <div class="draggable" draggable="true" id="a1" ondragstart="drag(event)">Ausstellung √ºber Finanzmetropole.</div>
      <div class="draggable" draggable="true" id="a2" ondragstart="drag(event)">Fachinformationen f√ºr Finanzprofis.</div>
      <div class="draggable" draggable="true" id="a3" ondragstart="drag(event)">Finanz-ABC f√ºr Anf√§nger.</div>
      <div class="draggable" draggable="true" id="a4" ondragstart="drag(event)">Interessante T√§tigkeit wichtiger als hohes Gehalt.</div>
      <div class="draggable" draggable="true" id="a5" ondragstart="drag(event)">Lehrreicher Rundgang zu Finanzwissen.</div>
      <div class="draggable" draggable="true" id="a6" ondragstart="drag(event)">Sammelgef√§√üe als Ausstellungsobjekte.</div>
      <div class="draggable" draggable="true" id="a7" ondragstart="drag(event)">Sparb√ºchsen - Nun wieder in Mode.</div>
      <div class="draggable" draggable="true" id="a8" ondragstart="drag(event)">Vertrauen zeigt sich auf dem Konto.</div>
      <div class="draggable" draggable="true" id="a9" ondragstart="drag(event)">Wie Kinder den Umgang mit Geld lernen.</div>
      <div class="draggable" draggable="true" id="a10" ondragstart="drag(event)">Wie man Kinder zum Sparen motiviert.</div>
    </div>
  </div>
</div>

<div id="result"></div>

<div class="button-container">
  <button onclick="submitQuiz()" class="quiz-button">
    <i class="fas fa-paper-plane"></i> Abschicken
  </button>
  <button onclick="resetQuiz()" class="quiz-button secondary">
      <i class="fas fa-redo"></i> Zur√ºcksetzen
  </button>
  <a href="/b2_exam.html" class="quiz-button-link secondary"> <!-- Replace # with your actual home link -->
    <i class="fas fa-home"></i> Zur√ºck zur Startseite
  </a>
</div>



<script>
  const rightColumnContent = document.querySelector(".right-column .right-column-content");
  const originalAnswerOrder = Array.from(rightColumnContent.querySelectorAll('.draggable'));
  let selectedDraggable = null; // To store the currently click-selected draggable item

  // --- CLICK-TO-DROP/PICKUP LOGIC ---
  function selectItem(item) {
    if (selectedDraggable) {
      selectedDraggable.classList.remove('selected');
    }
    selectedDraggable = item;
    if (selectedDraggable) {
      selectedDraggable.classList.add('selected');
    }
  }

  function deselectItem() {
    if (selectedDraggable) {
      selectedDraggable.classList.remove('selected');
      selectedDraggable = null;
    }
  }

  function handleDraggableClicked(event) {
    const clickedItem = event.currentTarget;
    event.stopPropagation(); // Prevent click bubbling to parent elements like answer pool

    if (selectedDraggable === clickedItem) { // Clicking the already selected item
      deselectItem();
      // If it was in a target and now deselected by clicking it, move it back to pool
      if (clickedItem.parentElement.classList.contains('drop-target')) {
           const parentDropTarget = clickedItem.parentElement;
           rightColumnContent.appendChild(clickedItem);
           updateDropTargetVisualState(parentDropTarget);
           parentDropTarget.classList.remove('correct', 'incorrect'); // Clear feedback
      }
    } else { // Clicking a new item, or an unselected item in a target
      // If the clicked item is currently in a drop target, "pick it up" by moving to pool first
      if (clickedItem.parentElement.classList.contains('drop-target')) {
          const parentDropTarget = clickedItem.parentElement;
          rightColumnContent.appendChild(clickedItem); // Move to pool
          updateDropTargetVisualState(parentDropTarget);
          parentDropTarget.classList.remove('correct', 'incorrect'); // Clear feedback
      }
      selectItem(clickedItem); // Then select it (it's now in the pool)
    }
  }

  function handleDropTargetClicked(event) {
    const clickedDropTarget = event.currentTarget;
    event.stopPropagation();

    if (selectedDraggable) { // If an item is selected, try to place it here
      const existingItemInTarget = clickedDropTarget.querySelector('.draggable');
      if (existingItemInTarget && existingItemInTarget !== selectedDraggable) {
        rightColumnContent.appendChild(existingItemInTarget); // Move old item from target back to pool
        // No need to deselect existingItemInTarget here, as it wasn't the 'selectedDraggable'
      }

      clickedDropTarget.innerHTML = ''; // Clear target (removes placeholder or old item)
      clickedDropTarget.appendChild(selectedDraggable); // Place new item
      updateDropTargetVisualState(clickedDropTarget);
      clickedDropTarget.classList.remove('correct', 'incorrect'); // Clear any feedback
      deselectItem(); // Item is placed, so deselect
    } else if (!selectedDraggable && clickedDropTarget.querySelector('.draggable')) {
      // No item is selected, AND the clicked drop target HAS an item: "pick up" that item.
      const itemToPickUp = clickedDropTarget.querySelector('.draggable');
      rightColumnContent.appendChild(itemToPickUp); // Move it to the pool
      updateDropTargetVisualState(clickedDropTarget);
      clickedDropTarget.classList.remove('correct', 'incorrect'); // Clear feedback
      selectItem(itemToPickUp); // And select it (it's now in the pool)
    }
  }

  function handleAnswerPoolClicked(event) {
    // If click is on the pool itself (not a draggable within it) and an item is selected
    if (event.target === rightColumnContent && selectedDraggable) {
      // If selected item is somehow not in pool (e.g. if logic changes), ensure it is
      if (selectedDraggable.parentElement !== rightColumnContent) {
           rightColumnContent.appendChild(selectedDraggable);
      }
      // The main purpose here: clicking the pool with a selected item deselects it.
      deselectItem();
    }
  }

  function initializeClickInteractions() {
    document.querySelectorAll('.draggable').forEach(item => {
      item.addEventListener('click', handleDraggableClicked);
    });
    document.querySelectorAll('.drop-target').forEach(target => {
      target.addEventListener('click', handleDropTargetClicked);
    });
    rightColumnContent.addEventListener('click', handleAnswerPoolClicked);
  }

  // --- DRAG AND DROP LOGIC (MODIFIED) ---
  function allowDrop(ev) {
    ev.preventDefault();
    let potentialDropTarget = ev.target;
    while(potentialDropTarget && !potentialDropTarget.classList.contains('drop-target') && !potentialDropTarget.classList.contains('right-column-content')) {
        potentialDropTarget = potentialDropTarget.parentElement;
    }
    if (potentialDropTarget && potentialDropTarget.classList.contains('drop-target')) {
        potentialDropTarget.classList.add("drag-over");
    }
  }

  document.addEventListener('dragleave', function(event) {
    if (event.target.classList && event.target.classList.contains("drop-target")) {
      event.target.classList.remove("drag-over");
    }
  }, false);

  function drag(ev) {
    ev.dataTransfer.setData("text", ev.target.id);
    ev.target.classList.add("dragging");
    deselectItem(); // Deselect any click-selected item when a drag operation starts
  }

  document.addEventListener('dragend', function(event) {
    if (event.target.classList && event.target.classList.contains('draggable')) {
      event.target.classList.remove('dragging');
    }
    document.querySelectorAll('.drop-target.drag-over').forEach(dt => dt.classList.remove('drag-over'));
  });

  function drop(ev) {
    ev.preventDefault();
    const draggedId = ev.dataTransfer.getData("text");
    const draggedEl = document.getElementById(draggedId);
    let dropTargetEl = ev.target;

    if (!draggedEl) return; // Safety check

    draggedEl.classList.remove("dragging");
    document.querySelectorAll('.drop-target.drag-over').forEach(dt => dt.classList.remove('drag-over'));

    while (dropTargetEl &&
           !dropTargetEl.classList.contains("drop-target") &&
           !dropTargetEl.classList.contains("right-column-content")) {
      dropTargetEl = dropTargetEl.parentElement;
    }

    if (!dropTargetEl) return;

    if (dropTargetEl.classList.contains("drop-target")) {
      const currentAnswer = dropTargetEl.querySelector(".draggable");
      if (currentAnswer && currentAnswer !== draggedEl) {
        rightColumnContent.appendChild(currentAnswer);
        currentAnswer.classList.remove('selected'); // Ensure item moved back is not selected
      }
      dropTargetEl.innerHTML = "";
      dropTargetEl.appendChild(draggedEl);
      dropTargetEl.classList.remove("correct", "incorrect");
      updateDropTargetVisualState(dropTargetEl);
    }
    else if (dropTargetEl.classList.contains("right-column-content")) {
      const originalParent = draggedEl.parentElement; // Get parent BEFORE moving
      rightColumnContent.appendChild(draggedEl);
      if (originalParent && originalParent.classList.contains('drop-target')) {
          updateDropTargetVisualState(originalParent); // Update visual state of original drop target
          originalParent.classList.remove('correct', 'incorrect');
      }
    }
    deselectItem(); // Deselect any click-selected item after a drop operation
  }

  function updateDropTargetVisualState(dropTarget) {
    if (!dropTarget || !dropTarget.classList.contains('drop-target')) return;
    if (dropTarget.querySelector(".draggable")) {
      dropTarget.classList.remove("empty-drop-target");
    } else {
      dropTarget.classList.add("empty-drop-target");
    }
  }

  // --- QUIZ FUNCTIONALITY (MODIFIED RESET) ---
  function submitQuiz() {
    let total = 0;
    let correct = 0;
    deselectItem(); // Ensure nothing is selected when submitting

    document.querySelectorAll('.question-box').forEach((box) => {
      total++;
      const correctAnswer = box.getAttribute("data-correct").trim();
      const dropTarget = box.querySelector(".drop-target");
      const droppedDraggable = dropTarget.querySelector(".draggable");
      dropTarget.classList.remove("correct", "incorrect");
      if (droppedDraggable) {
        const selectedText = droppedDraggable.textContent.trim();
        if (selectedText === correctAnswer) {
          dropTarget.classList.add("correct");
          correct++;
        } else {
          dropTarget.classList.add("incorrect");
        }
      } else {
        dropTarget.classList.add("incorrect");
      }
    });
    const resultDiv = document.getElementById("result");
    resultDiv.innerHTML =
      `Du hast <span class="correct-count">${correct}</span> von <span class="total-count">${total}</span> Fragen richtig beantwortet.`;
  }

  function resetQuiz() {
    deselectItem(); // Clear any click-selection first

    document.querySelectorAll('.drop-target').forEach(dt => {
        const draggable = dt.querySelector('.draggable');
        if (draggable) {
            rightColumnContent.appendChild(draggable);
            draggable.classList.remove('selected'); // Make sure it's not selected style
        }
        dt.innerHTML = '';
        dt.classList.remove('correct', 'incorrect');
        updateDropTargetVisualState(dt);
    });

    rightColumnContent.innerHTML = '';
    originalAnswerOrder.forEach(draggable => {
        rightColumnContent.appendChild(draggable);
        draggable.classList.remove('dragging'); // Just in case
        draggable.classList.remove('selected'); // Ensure no selected style
    });

    document.getElementById("result").innerHTML = "";
    document.querySelectorAll('.drop-target').forEach(updateDropTargetVisualState);
  }

  // --- INITIALIZATION ---
  document.querySelectorAll('.drop-target').forEach(updateDropTargetVisualState);
  initializeClickInteractions(); // Add this line to set up click listeners

</script>
<script>
let pingTimeout;
let logoutTimer;
let warningTimer;
let countdownTimer;
let lastPing = 0;

const INACTIVITY_LIMIT = 15 * 60 * 1000; // 15 minutes
const WARNING_BEFORE_LOGOUT = 30 * 1000; // 30 seconds
const warningBox = document.getElementById("warningBox");
const countdownEl = document.getElementById("countdown");

function sendPing() {
    const now = Date.now();
    if (now - lastPing < 10000) return; 
    lastPing = now;
    fetch("/ping").catch(() => {});
}

function resetTimers() {
    clearTimeout(pingTimeout);
    clearTimeout(logoutTimer);
    clearTimeout(warningTimer);
    clearInterval(countdownTimer);

    warningBox.style.display = "none"; // üü° hide warning if active again

    sendPing();
    pingTimeout = setTimeout(sendPing, 60 * 1000);

    // Show warning 30s before logout
    warningTimer = setTimeout(() => {
        let remaining = 30;
        warningBox.style.display = "block";
        countdownEl.textContent = remaining;

        countdownTimer = setInterval(() => {
            remaining--;
            countdownEl.textContent = remaining;
            if (remaining <= 0) {
                clearInterval(countdownTimer);
            }
        }, 1000);
    }, INACTIVITY_LIMIT - WARNING_BEFORE_LOGOUT);

    // Auto logout
    logoutTimer = setTimeout(() => {
        fetch("/logout", { method: "POST" })
          .then(() => window.location.href = "/");
    }, INACTIVITY_LIMIT);
}

// Events
["mousemove", "keydown", "scroll", "click", "touchstart"].forEach(evt => {
    document.addEventListener(evt, resetTimers);
});

window.addEventListener("pageshow", sendPing);
window.addEventListener("beforeunload", sendPing);

resetTimers();
</script>


</body>
</html>