
<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Fernsehprogramm</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Font Awesome for Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* ========================================= */
    /*        1. PROFESSIONAL VARIABLES          */
    /* ========================================= */
    :root {
      /* Palette */
      --primary: #1e293b;       
      --primary-soft: #e0e7ff;
      --bg-body: #f8fafc;       
      --surface: #ffffff;
      
      --text-main: #0f172a;     
      --text-muted: #64748b;    
      
      --success: #10b981;
      --success-bg: #ecfdf5;
      --error: #ef4444;
      --error-bg: #fef2f2;

      /* Dimensions */
      --radius: 12px;
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      
      --header-height: 60px;
      /* INCREASED HEIGHT FOR MOBILE SLIDER */
      --mobile-answer-height: 170px; 
    }

    *, *::before, *::after { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

    body {
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      margin: 0;
      padding: 0;
      background-color: var(--bg-body);
      color: var(--text-main);
      min-height: 100vh;
      line-height: 1.5;
    }

    /* ========================================= */
    /*           2. HEADER (FIXED)               */
    /* ========================================= */
    .header {
      position: fixed;
      top: 0; left: 0; width: 100%;
      height: var(--header-height);
      background: var(--primary);
      border-bottom: 1px solid rgba(0,0,0,0.08);
      color: var(--surface);
      z-index: 2000;
      display: flex; align-items: center; justify-content: center;
      font-weight: 800; font-size: 1.2rem;
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
      margin: 0;
    }

    /* ========================================= */
    /*           3. LAYOUT CONTAINER             */
    /* ========================================= */
    .container {
      max-width: 1280px;
      margin: 0 auto;
      padding-top: calc(var(--header-height) + 30px);
      padding-bottom: 60px;
      padding-left: 20px; padding-right: 20px;
      display: flex;
      gap: 30px;
      align-items: flex-start;
    }

    /* ========================================= */
    /*        4. LEFT COLUMN (QUESTIONS)         */
    /* ========================================= */
    .left-column {
      width: 65%;
      flex-shrink: 0;
    }

    .quiz-scroll-container {
      background: transparent;
      padding: 0;
      box-shadow: none;
      max-height: none;
      overflow: visible;
    }

    .question-box {
      background: var(--surface);
      border-radius: var(--radius);
      padding: 25px;
      margin-bottom: 24px;
      box-shadow: var(--shadow);
      border: 1px solid #e2e8f0;
      border-left: 5px solid var(--primary);
    }

    .question-text {
      font-size: 1rem;
      color: #334155;
      margin-top: 15px;
    }
    
    .question-text h4 { margin-top: 0; color: var(--primary); margin-bottom: 8px; }

    /* DROP ZONES */
    .drop-target {
      background-color: #f1f5f9;
      border: 2px dashed #cbd5e1;
      border-radius: 10px;
      min-height: 60px;
      display: flex; align-items: center; justify-content: center;
      transition: all 0.2s;
      cursor: pointer;
      position: relative;
      margin-bottom: 15px;
    }

    .drop-target.empty-drop-target::before {
      content: "Hier Antwort ablegen";
      color: #94a3b8; font-size: 0.9rem; font-weight: 500;
      pointer-events: none;
    }

    .drop-target.drag-over {
      background-color: var(--primary-soft);
      border-color: var(--primary);
      transform: scale(1.01);
    }

    /* DROPPED ITEMS */
    .drop-target .draggable {
      background: transparent; border: none; box-shadow: none;
      width: 100%; margin: 0; padding: 5px;
      text-align: center; color: var(--primary); font-weight: 700;
      flex-direction: column;
    }

    /* ========================================= */
    /*        5. RIGHT COLUMN (ANSWERS)          */
    /* ========================================= */
    .right-column {
      width: 30%;
      position: sticky; 
      top: calc(var(--header-height) + 20px); 
      height: calc(100vh - 100px);
      z-index: 1000;
    }

    .right-column-content {
      background: var(--surface);
      padding: 15px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border: 1px solid #e2e8f0;
      max-height: 100%;
      overflow-y: auto;
    }

    /* DRAGGABLE CARDS */
    .draggable {
      background: white;
      border: 1px solid #e2e8f0;
      padding: 12px 15px;
      margin-bottom: 10px;
      border-radius: 8px;
      cursor: grab;
      font-size: 0.9rem; font-weight: 500; color: #334155;
      box-shadow: 0 1px 2px rgba(0,0,0,0.04);
      display: flex; align-items: flex-start; gap: 10px;
      user-select: none;
    }

    .draggable.selected {
      background-color: var(--primary);
      color: white;
      border-color: var(--primary);
    }

    /* CHECKBOX Styling */
    .wrong-flag {
      width: 18px; height: 18px;
      margin-top: 3px;
      flex-shrink: 0;
      cursor: pointer;
      accent-color: var(--error);
    }

    /* ========================================= */
    /*        6. FEEDBACK & BUTTONS              */
    /* ========================================= */
    .drop-target.correct { background: var(--success-bg) !important; border-color: var(--success) !important; }
    .drop-target.correct .draggable { color: #065f46 !important; }
    .drop-target.incorrect { background: var(--error-bg) !important; border-color: var(--error) !important; }
    .drop-target.incorrect .draggable { color: #991b1b !important; }

    /* Buttons */
    .button-container { display: flex; justify-content: center; gap: 15px; margin-top: 40px; margin-bottom: 40px;}
    
    .quiz-button {
      background: var(--text-main); color: white;
      padding: 14px 28px; border-radius: 50px;
      font-weight: 600; border: none; cursor: pointer;
      display: flex; align-items: center; gap: 8px; font-size: 1rem;
      transition: all 0.2s;
      box-shadow: var(--shadow);
      text-decoration: none;
    }
    
    .quiz-button.secondary {
      background: white; color: var(--text-main); border: 1px solid #cbd5e1;
    }

    #result { text-align: center; margin-top: 20px; font-weight: bold; padding: 20px; background: white; border-radius: var(--radius); box-shadow: var(--shadow); }

    /* ========================================= */
    /*           7. MOBILE RESPONSIVE            */
    /* ========================================= */
    @media (max-width: 991px) {
      
      .header { font-size: 1rem; padding: 0 10px; }

      .container {
        flex-direction: column;
        padding: 0;
        /* Padding Top = Header + Bigger AnswerBar + Gap */
        padding-top: calc(var(--header-height) + var(--mobile-answer-height) + 25px);
      }

      /* 1. ANSWER BAR (FIXED TOP HORIZONTAL SLIDER) */
      .right-column {
        position: fixed;
        top: var(--header-height);
        left: 0; width: 100%;
        height: var(--mobile-answer-height);
        z-index: 1500;
        
        background: #f8fafc; /* Match body bg */
        border-bottom: 1px solid rgba(0,0,0,0.1);
        box-shadow: 0 4px 10px -2px rgba(0,0,0,0.05);
      }

      .right-column-content {
        display: flex; 
        flex-direction: row; 
        gap: 12px;
        /* Increased padding inside the slider to prevent clipping */
        padding: 15px 15px;
        
        height: 100%; width: 100%;
        background: transparent;
        border: none; box-shadow: none; border-radius: 0;
        
        overflow-x: auto; 
        overflow-y: hidden;
        white-space: normal;
        scroll-snap-type: x mandatory;
        align-items: center; /* Center vertically */
      }
      .right-column-content::-webkit-scrollbar { display: none; }

      /* Mobile Draggable Cards */
      .draggable {
        flex: 0 0 auto;
        width: 250px; /* Slightly wider */
        height: calc(100% - 10px); /* Leave room for shadow */
        margin: 0;
        
        display: flex; 
        align-items: flex-start; /* Align text top */
        justify-content: center; 
        text-align: left;
        
        font-size: 0.8rem;
        padding: 10px;
        scroll-snap-align: center;
        border: 1px solid #e2e8f0;
        background: white;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      }
      
      .draggable input.wrong-flag {
          margin-top: 2px; /* Fix checkbox alignment */
      }

      /* 2. Questions */
      .left-column { width: 100%; padding: 0 15px; }
      .question-box { padding: 20px; }

      /* 3. Buttons */
      .button-container { flex-direction: column; padding: 0 15px; gap: 10px; }
      .quiz-button { width: 100%; justify-content: center; }
    }
  </style>
</head>
<body>

<div class="header">Lesen Teil 3: Fernsehprogramm</div>

<div class="container">
  <div class="left-column">
    <div class="quiz-scroll-container">
      <!-- Questions -->
      <div class="question-box" data-correct="Eine Bekannte interessiert sich f√ºr informative Beitr√§ge zur neueren Geschichte./ Eine Bekannte interessiert sich f√ºr die Geschichte des bis 1989 geteilten Berlins.">
        <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
        <div class="question-text">
          <h4>23.15 3SAT Es geschah im August</h4>
          Ullrich Kasten und Hans-Hermann Hertle schildern in ihrer hervorragenden Dokumentation anhand von Archivmaterial minuti√∂s s√§mtliche Stationen des Mauerbaus. Sie erz√§hlen die Vorgeschichte der Berlin-Krise und beleuchten die Hintergr√ºnde der Teilung Deutschlands. Ferner haben sie Zeitzeugen nach ihren Reaktionen auf das einschneidende Ereignis befragt. Zu Wort kommen in dem Film nicht nur namhafte Vertreter der internationalen Politik, sondern auch Grenzsoldaten, Fl√ºchtlinge und Angeh√∂rige von Maueropfern.
        </div>
      </div>
      <div class="question-box" data-correct="Sie suchen eine abwechslungsreiche Musiksendung mit Klaviermusik.">
        <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
        <div class="question-text">
          <h4>21.00 NDR Joja Wendt</h4>
          Ob Klassik, Rock'n'Roll oder Jazz, Joja Wendt, Hamburger Pianist mit enormen Entertainer-Qualit√§ten, variiert bekannte Songs und stellt seine Fingerfertigkeit auch in eigenen Kompositionen unter Beweis. Stargast in dem heutigen Fernseh-Special ist die Schlagers√§ngerin Michelle mit dem Titel "Ich schicke dir jetzt einen Engel".
        </div>
      </div>
      <!-- THIS QUESTION HAS NO CORRECT ANSWER -->
      <div class="question-box" data-correct="__NO_CORRECT_ANSWER__">
        <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
        <div class="question-text">
          <h4>20.15 SAT1 Einfach unwiderstehlich</h4>
          Gut kochen kann Amanda nicht. Folglich steht ihr kleines, von der Mutter geerbtes Restaurant in Manhattan kurz vor dem Aus. Da entflieht pl√∂tzlich ein Krebs aus ihrem Einkaufskorb und sorgt mit seinen Zauberk√ºnsten f√ºr lukullische Sensationen. Tom, Manager eines Gourmet-Restaurants an der Fifth Avenue, kommt als einer der ersten in deren Genuss. Amanda hat sich in ihn verliebt, als der schon bekannte Krebs unter Toms Hosenbein fl√ºchtet. Seine Zauber-kr√§fte werden dringend gebraucht, denn Tom geh√∂rt zu den M√§nnern, die ziemlich viel Angst vor Liebesbeziehungen haben.
        </div>
      </div>
      <div class="question-box" data-correct="Sie sehen gern spannende, aber auch spa√üige Agentenfilme.">
        <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
        <div class="question-text">
          <h4>22.00 HR New York Express</h4>
          Aus Sorge um die nationale Sicherheit versteckt der amerikanische Geheimdienst den genialen, aber vermeintlich psychisch kranken Physiker Arthur Vincenti. Der v√∂llig verr√ºckte New Yorker Psychiater Dr. Snow erh√§lt den Auftrag, ihn zu heilen. Immer nachts wird er mit verbundenen Augen zu dem Versteck gebracht. Aber auch einige Gangster sind nicht unt√§tig. Sie haben es auf das Wissen des Geheimnistr√§gers Vincenti abgesehen, dass sie fremden Spionen verkaufen m√∂chten.
        </div>
      </div>
      <div class="question-box" data-correct="Sie m√∂gen Familienkom√∂dien, besonders mit frechen Kindern.">
        <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
        <div class="question-text">
          <h4>20.15 PRO 7 Kein Vater von gestern</h4>
          Er schreit wie am Spie√ü, wenn er lange Hosen tragen soll, und lacht sich kaputt, wenn er die Katze in eine M√ºllt√ºte gesteckt hat. Alles ist einfacher, als sich um den 5-j√§hrigen Calvin zu k√ºmmern. Doch sein liebevoller Vater Russell, der den Jungen allein erzieht, meistert s√§mtliche Katastrophen mit Bravour und Geduld. Weil sich Kind und Karriere nicht unter einen Hut bringen lie√üen, verlor der Jurist einen tollen Job in einer renommierten Chicagoer Anwaltskanzlei. Jetzt sitzt er mit seinem Sohn in einem Dorf in Kansas und arbeitet in der Kanzlei eines Freundes. Die Bekanntschaft mit der attraktiven Beth bringt neuen Schwung in sein Leben. Doch da taucht Russells Ex-Ehefrau wieder auf.
        </div>
      </div>
      <div class="question-box" data-correct="Sie w√ºrden gern etwas √ºber Gro√üstadtjugendliche erfahren, die am Rand der Gesellschaft leben.">
        <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
        <div class="question-text">
          <h4>22.45 SAT1 Nur nich' nach Hause</h4>
          "Hier in Berlin bei meinen Freunden habe ich mein Zuhause hinter mir gelassen. Hier geht's mir gut. Ich bin endlich frei", sagt Sascha. Der 16-J√§hrige ist einer der Jugendlichen, die hierzulande auf der Stra√üe leben. Sie schlafen in Notunterk√ºnften, Treppenh√§usern und U-Bahn-Stationen, betteln tags√ºber Passanten um Kleingeld an. Peter Schmidt hat Sascha mehrere Wochen lang begleitet und ihn nach seinen W√ºnschen und Hoffnungen gefragt. Zudem beleuchtet der Filmautor die individuelle Geschichte des Jugendlichen.
        </div>
      </div>
      <!-- THIS QUESTION HAS NO CORRECT ANSWER -->
      <div class="question-box" data-correct="__NO_CORRECT_ANSWER__">
        <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
        <div class="question-text">
          <h4>21.15 ARD Gro√üer Kick auf schmalem Grat</h4>
          Mit Sandalen und T-Shirt h√§ngen sie in den Felsw√§nden, ihr Handy halten sie f√ºr eine Lebensversicherung, die Alpen f√ºr einen Freizeitpark, Vierzig Menschen verungl√ºcken jedes Jahr t√∂dlich am Montblanc, bis zu eintausend Eins√§tze fliegt die Bergwacht Chamonix pro Saison. Filmer Oliver Baumgart begleitet die Retter zwei Wochen lang.
        </div>
      </div>
      <div class="question-box" data-correct="Sie m√∂gen Filme mit viel Action und viel Spa√ü. Ihre Lieblingshelden k√∂nnen auch mal zuschlagen.">
        <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
        <div class="question-text">
          <h4>20.15 RTL Zwei Engel mit vier F√§usten: Schwere Jungs</h4>
          "Schwere Jungs" bildet den Auftakt zu einer sechsteiligen Reihe mit Actionkom√∂dien: Hau-drauf-Filme, wie sie schon unz√§hlige Male mit dem Schl√§ger-Duo Terence Hill und Bud Spencer √ºber den Bildschirm flimmerten. Die Beiden Gauner Joe und Bob fliehen aus dem Gef√§ngnis und finden als M√∂nche getarnt Unterschlupf in einer Missionsstation.
        </div>
      </div>
      <div class="question-box" data-correct="Ihre Bekannten verfolgen gern sportliche Wettk√§mpfe./ Bekannte interessieren sich f√ºr Wintersportveranstaltungen.">
        <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
        <div class="question-text">
          <h4>17.30 ZDF Olympia-Highlights</h4>
          Nach den Weltcup-Siegen in Willingen und Sapporo stehen die Chancen f√ºr das √∂sterreichische Team gut, beim Skispringen ganz weit vorn zu landen. √úberflieger Gregor Schlierenzauer und sein Mannschaftskollege Thomas Morgenstern sind jedenfalls in blendender Verfassung. Die deutschen Springer Martin Schmitt und J√∂rg Ritzerfeld werden sich anstrengen m√ºssen. √úbertragung von der 120-Meter-Skisprungschanze im Utah Olympic Park.
        </div>
      </div>
      <!-- THIS QUESTION HAS NO CORRECT ANSWER -->
      <div class="question-box" data-correct="__NO_CORRECT_ANSWER__">
        <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
        <div class="question-text">
          <h4>14.15 DRS Basler Fasnacht</h4>
          Man darf gespannt sein, wie viel Spott die f√ºr ihre spitzen Zungen bekannten Basler Fasn√§chtler f√ºr das vergangene Jahr √ºbrighaben. DRS √ºbertr√§gt die Stra√üenfasnacht, den Umzug der Pfeifen- und Trommlergruppen, die ihre Themen pr√§sentieren, live. Die fachkundigen Kommentare zum Karneval am Oberrhein liefern Robert Pichler und der Basler Fastnachtsjournalist Roger Thiriet.
        </div>
      </div>
      <!-- THIS QUESTION HAS NO CORRECT ANSWER -->
      <div class="question-box" data-correct="__NO_CORRECT_ANSWER__">
        <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
        <div class="question-text">
          <h4>0.05 BR Rockpalast</h4>
          Dreizehn Alben hat die vielk√∂pfige korsische Gruppe "I Muvrini" um die Br√ºder Jean-Francois und Alain Bernardini bereits ver√∂ffentlicht. Hierzulande galten die "wilden Schafe" noch bis vor Kurzem als Geheimtipp. Inzwischen sind die Musiker mit ihrer Mischung aus korsischer Folklore, afrikanischen und keltischen Elementen, aber auch aus Jazz, Pop und Cajun bei uns bekannt.
        </div>
      </div>
      <div class="question-box" data-correct="Ein Bekannter m√∂chte einen Film sehen, der nach dem Werk eines Schriftstellers gedreht wurde.">
        <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
        <div class="question-text">
          <h4>20.15 PHOENIX Mephisto</h4>
          Man sollte meinen, Schauspieler Hendrik H√∂fgen w√§re gegen unmoralische Angebote gefeit. Schlie√ülich feierte er zur Zeit der Weimarer Republik gro√üe Erfolge in der Rolle des Mephisto. Der Mann m√ºsste also wissen, wie schnell es gehen kann, dass man seine Seele verkauft. Als die Nazis die Macht ergreifen, stellt H√∂fgen seine Kunst ganz in den Dienst der neuen Herrscher. Und bald wird er zum Intendanten des Staatstheaters ernannt. Das Drama um Kunst und Politik entstand nach dem gleichnamigen Roman von Klaus Mann.
        </div>
      </div>
    </div>
  </div>

  <div class="right-column">
    <!-- MODIFIED: Added ondragover and ondrop to make this a droppable area -->
    <div class="right-column-content" onclick="clearSelected()" ondragover="allowDrop(event)" ondrop="dropOnAnswersContainer(event)">
      <!-- Answers -->
      <div class="draggable" draggable="true" id="a1" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
        <input type="checkbox" class="wrong-flag" onclick="event.stopPropagation()"> Ein Bekannter m√∂chte einen Film sehen, der nach dem Werk eines Schriftstellers gedreht wurde.
      </div>
      <div class="draggable" draggable="true" id="a2" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
        <input type="checkbox" class="wrong-flag" onclick="event.stopPropagation()"> Ihre Bekannten verfolgen gern sportliche Wettk√§mpfe./ Bekannte interessieren sich f√ºr Wintersportveranstaltungen.
      </div>
      <div class="draggable" draggable="true" id="a3" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
        <input type="checkbox" class="wrong-flag" onclick="event.stopPropagation()"> Sie suchen eine abwechslungsreiche Musiksendung mit Klaviermusik.
      </div>
      <div class="draggable" draggable="true" id="a4" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
        <input type="checkbox" class="wrong-flag" onclick="event.stopPropagation()"> Sie m√∂gen Filme mit viel Action und viel Spa√ü. Ihre Lieblingshelden k√∂nnen auch mal zuschlagen.
      </div>
      <div class="draggable" draggable="true" id="a5" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
        <input type="checkbox" class="wrong-flag" onclick="event.stopPropagation()"> Ein Bekannter interessiert sich f√ºr korsische Geschichte.
      </div>
      <div class="draggable" draggable="true" id="a6" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
        <input type="checkbox" class="wrong-flag" onclick="event.stopPropagation()"> Sie m√∂gen Familienkom√∂dien, besonders mit frechen Kindern.
      </div>
      <div class="draggable" draggable="true" id="a7" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
        <input type="checkbox" class="wrong-flag" onclick="event.stopPropagation()"> Eine Bekannte interessiert sich f√ºr informative Beitr√§ge zur neueren Geschichte./ Eine Bekannte interessiert sich f√ºr die Geschichte des bis 1989 geteilten Berlins.
      </div>
      <div class="draggable" draggable="true" id="a8" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
        <input type="checkbox" class="wrong-flag" onclick="event.stopPropagation()"> Sie sehen gern spannende, aber auch spa√üige Agentenfilme.
      </div>
      <div class="draggable" draggable="true" id="a9" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
        <input type="checkbox" class="wrong-flag" onclick="event.stopPropagation()"> Sie w√ºrden gern etwas √ºber Gro√üstadtjugendliche erfahren, die am Rand der Gesellschaft leben.
      </div>
      <div class="draggable" draggable="true" id="a10" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
        <input type="checkbox" class="wrong-flag" onclick="event.stopPropagation()"> Sie m√∂chten im n√§chsten Urlaub bergsteigen und sich √ºber die Risiken informieren.
      </div>
    </div>
  </div>
</div>

<div id="result"></div>
<div class="button-container">
    <button id="submitQuizButton" class="quiz-button">
      <i class="fas fa-paper-plane"></i> Abschicken
    </button>
    <button id="resetQuizButton" class="quiz-button secondary">
      <i class="fas fa-redo"></i> Zur√ºcksetzen
    </button>
    <!-- Changed to <a> tag for navigation, href to a generic "index.html" or "#" -->
    <a href="/b2_exam.html" id="homeButton" class="quiz-button secondary" role="button">
      <i class="fas fa-home"></i> Startseite
    </a>
  </div>

<script>
  let selectedAnswer = null;
  const rightColumnContent = document.querySelector(".right-column-content");
  const originalAnswerOrder = Array.from(rightColumnContent.querySelectorAll('.draggable')); // Store initial order for reset

  // MODIFIED: allowDrop to correctly identify parent droppable container
  function allowDrop(ev) {
    ev.preventDefault();
    let droppableContainer = ev.target;
    // Traverse up to find the actual droppable container (.drop-target or .right-column-content)
    while (droppableContainer && droppableContainer !== document.body &&
           !droppableContainer.classList.contains("drop-target") &&
           !droppableContainer.classList.contains("right-column-content")) {
        droppableContainer = droppableContainer.parentElement;
    }

    if (droppableContainer && (droppableContainer.classList.contains("drop-target") || droppableContainer.classList.contains("right-column-content"))) {
        droppableContainer.classList.add("drag-over");
    }
  }

  function drag(ev) {
    ev.dataTransfer.setData("text", ev.target.id);
    ev.target.classList.add("dragging");
    // Store the original parent in case the drag is to another drop-target
    // This can be complex if not dropped successfully; let's manage parentage in drop handlers
  }

  // MODIFIED: Original document 'dragleave' listener is kept, but dragend cleanup is more robust.
  document.addEventListener('dragleave', function(event) {
    // This simple version only removes drag-over if event.target is the droppable itself.
    // More complex logic (checking event.relatedTarget) is needed for perfect behavior
    // when dragging over children, but dragend cleanup will handle most cases.
    if (event.target.classList && (event.target.classList.contains("drop-target") || event.target.classList.contains("right-column-content"))) {
        // A basic check: if relatedTarget is outside this element, remove drag-over
        if (!event.target.contains(event.relatedTarget) && event.target !== event.relatedTarget) {
             event.target.classList.remove("drag-over");
        } else if (event.relatedTarget === null) { // Mouse left the window
            event.target.classList.remove("drag-over");
        }
    }
  }, false);
  
  // MODIFIED: dragend to clean up all drag-over classes
  document.addEventListener('dragend', function(event) {
    if (event.target.classList && event.target.classList.contains('draggable')) {
      event.target.classList.remove('dragging');
    }
    // Global cleanup for any remaining drag-over states
    document.querySelectorAll('.drop-target.drag-over, .right-column-content.drag-over').forEach(el => {
        el.classList.remove('drag-over');
    });
  });

  // MODIFIED: drop function for question slots
  function drop(ev) {
    ev.preventDefault();
    const draggedId = ev.dataTransfer.getData("text");
    const draggedEl = document.getElementById(draggedId);
    let dropTarget = ev.target;

    while (dropTarget && !dropTarget.classList.contains("drop-target")) {
        dropTarget = dropTarget.parentElement;
    }
    
    if (!dropTarget || !draggedEl) return;

    dropTarget.classList.remove("drag-over");
    // draggedEl.classList.remove("dragging"); // Done by dragend

    const originalParentOfDraggedEl = draggedEl.parentElement; // Capture before moving

    const currentAnswerInTarget = dropTarget.querySelector(".draggable");
    if (currentAnswerInTarget && currentAnswerInTarget !== draggedEl) {
      rightColumnContent.appendChild(currentAnswerInTarget);
      showCheckbox(currentAnswerInTarget);
      // The targetDropzone (parent of currentAnswerInTarget) will be updated by updateDropTargetState(dropTarget)
    }
    
    dropTarget.innerHTML = ""; // Clear previous content
    dropTarget.appendChild(draggedEl);
    hideCheckbox(draggedEl);
    updateDropTargetState(dropTarget);

    // If the dragged element came from a *different* drop-target, update that one too.
    if (originalParentOfDraggedEl &&
        originalParentOfDraggedEl.classList.contains("drop-target") &&
        originalParentOfDraggedEl !== dropTarget) {
        updateDropTargetState(originalParentOfDraggedEl);
    }

    if (selectedAnswer === draggedEl) {
        draggedEl.classList.remove("selected");
        selectedAnswer = null;
    }
  }

  // NEW: Function to handle drops onto the answers container
  function dropOnAnswersContainer(ev) {
    ev.preventDefault();
    const draggedId = ev.dataTransfer.getData("text");
    const draggedEl = document.getElementById(draggedId);
    const answersContainer = ev.currentTarget; // This is right-column-content

    if (!draggedEl || !answersContainer) return;

    answersContainer.classList.remove("drag-over");
    // draggedEl.classList.remove("dragging"); // Done by dragend

    const originalParentOfDraggedEl = draggedEl.parentElement; // Capture before moving

    answersContainer.appendChild(draggedEl);
    showCheckbox(draggedEl);

    // If the dragged element came from a question's drop-target, update that drop-target's state
    if (originalParentOfDraggedEl && originalParentOfDraggedEl.classList.contains("drop-target")) {
        updateDropTargetState(originalParentOfDraggedEl);
    }

    if (selectedAnswer === draggedEl) {
        draggedEl.classList.remove("selected");
        selectedAnswer = null;
    }
  }


  function hideCheckbox(el) {
    const checkbox = el.querySelector(".wrong-flag");
    if (checkbox) checkbox.style.display = "none";
  }

  function showCheckbox(el) {
    const checkbox = el.querySelector(".wrong-flag");
    if (checkbox) checkbox.style.display = "inline-block";
  }

  function selectAnswer(el, event) {
    event.stopPropagation(); 
    if (selectedAnswer === el) { 
      el.classList.remove("selected");
      selectedAnswer = null;
    } else {
      if (selectedAnswer) selectedAnswer.classList.remove("selected");
      selectedAnswer = el;
      el.classList.add("selected");
    }
  }

  // MODIFIED: clickDrop function
  function clickDrop(targetDropzone) {
    if (selectedAnswer) {
      const originalParentOfSelectedAnswer = selectedAnswer.parentElement; // Capture before moving

      const currentAnswerInDropzone = targetDropzone.querySelector(".draggable");
      if (currentAnswerInDropzone && currentAnswerInDropzone !== selectedAnswer) {
        rightColumnContent.appendChild(currentAnswerInDropzone);
        showCheckbox(currentAnswerInDropzone);
      }
      
      targetDropzone.innerHTML = ""; 
      targetDropzone.appendChild(selectedAnswer);
      hideCheckbox(selectedAnswer);
      updateDropTargetState(targetDropzone);

      // If selectedAnswer came from a *different* drop-target, update that one.
      if (originalParentOfSelectedAnswer &&
          originalParentOfSelectedAnswer.classList.contains("drop-target") &&
          originalParentOfSelectedAnswer !== targetDropzone) {
          updateDropTargetState(originalParentOfSelectedAnswer);
      }
      // If it came from rightColumnContent, originalParentOfSelectedAnswer is rightColumnContent, no UI update needed for it.

      selectedAnswer.classList.remove("selected");
      selectedAnswer = null;
    }
  }

  function clearSelected() {
    if (selectedAnswer) {
      selectedAnswer.classList.remove("selected");
      selectedAnswer = null;
    }
  }

  function updateDropTargetState(dropTarget) {
    if (!dropTarget || !dropTarget.classList.contains('drop-target')) return;
    
    if (dropTarget.querySelector(".draggable")) {
      dropTarget.classList.remove("empty-drop-target");
    } else {
      dropTarget.classList.add("empty-drop-target");
    }
  }

  function getDraggableText(draggableElement) {
    const clone = draggableElement.cloneNode(true);
    const checkbox = clone.querySelector('.wrong-flag');
    if (checkbox) {
        checkbox.remove();
    }
    return clone.textContent.trim();
  }

  function submitQuiz() {
    let total = 0, correct = 0;
    document.querySelectorAll('.question-box').forEach((box) => {
      total++;
      const correctAnswerText = box.getAttribute("data-correct").trim();
      const dropTarget = box.querySelector(".drop-target");
      const droppedDraggable = dropTarget.querySelector(".draggable");
      
      dropTarget.classList.remove("correct", "incorrect"); 

      if (droppedDraggable) { 
        const selectedText = getDraggableText(droppedDraggable); 
        if (correctAnswerText === "__NO_CORRECT_ANSWER__") {
          dropTarget.classList.add("incorrect");
        } else {
          if (selectedText === correctAnswerText) {
            dropTarget.classList.add("correct");
            correct++;
          } else {
            dropTarget.classList.add("incorrect");
          }
        }
      } else { 
        if (correctAnswerText !== "__NO_CORRECT_ANSWER__") {
          dropTarget.classList.add("incorrect");
        }
      }
      updateDropTargetState(dropTarget); 
    });

    let wrongMarkedCorrect = 0, wrongMarkedTotal = 0;
    rightColumnContent.querySelectorAll('.draggable').forEach((answerEl) => {
      const text = getDraggableText(answerEl); 
      const checkbox = answerEl.querySelector('.wrong-flag');
      
      const isACorrectAnswerOptionForAnyQuestion = Array.from(document.querySelectorAll('.question-box'))
        .some(box => {
            const qCorrectText = box.getAttribute('data-correct').trim();
            return qCorrectText !== "__NO_CORRECT_ANSWER__" && qCorrectText === text;
        });
      
      if (!isACorrectAnswerOptionForAnyQuestion) { 
        wrongMarkedTotal++; 
        if (checkbox.checked) {
          wrongMarkedCorrect++; 
        }
      }
    });

    const questionsWithNoAnswer = Array.from(document.querySelectorAll('.question-box'))
                                      .filter(box => box.getAttribute('data-correct').trim() === "__NO_CORRECT_ANSWER__").length;
    const scorableTotal = total - questionsWithNoAnswer;


    const resultDiv = document.getElementById("result");
    resultDiv.innerHTML =
      `<span class="correct-count">‚úÖ ${correct}</span> von <span class="total-count">${scorableTotal}</span> bewertbaren Fragen richtig. | ` + 
      `<span class="marked-wrong-count">üö´ Falsch-Antworten korrekt markiert: ${wrongMarkedCorrect}</span> von ${wrongMarkedTotal}.`;
  }

  function resetQuiz() {
    document.querySelectorAll('.drop-target').forEach(dt => {
        const draggable = dt.querySelector('.draggable');
        if (draggable) {
            // Append to ensure it's at the end if others were returned individually
            rightColumnContent.appendChild(draggable); 
            showCheckbox(draggable); 
        }
        dt.innerHTML = ''; 
        dt.classList.remove('correct', 'incorrect'); 
        updateDropTargetState(dt); 
    });

    // Clear the right column first to avoid duplicates if an item was already returned
    rightColumnContent.innerHTML = ''; 
    originalAnswerOrder.forEach(draggable => {
        rightColumnContent.appendChild(draggable); 
        draggable.classList.remove('selected', 'dragging'); 
        showCheckbox(draggable); 
        const checkbox = draggable.querySelector('.wrong-flag');
        if (checkbox) checkbox.checked = false; 
    });
    
    if (selectedAnswer) {
      selectedAnswer.classList.remove('selected');
      selectedAnswer = null;
    }

    document.getElementById("result").innerHTML = ""; 
  }

  document.getElementById('submitQuizButton').addEventListener('click', submitQuiz);
  document.getElementById('resetQuizButton').addEventListener('click', resetQuiz);

  document.querySelectorAll('.drop-target').forEach(updateDropTargetState);
</script>
<script>
let pingTimeout;
let logoutTimer;
let warningTimer;
let countdownTimer;
let lastPing = 0;

const INACTIVITY_LIMIT = 15 * 60 * 1000; // 15 minutes
const WARNING_BEFORE_LOGOUT = 30 * 1000; // 30 seconds
const warningBox = document.getElementById("warningBox");
const countdownEl = document.getElementById("countdown");

function sendPing() {
    const now = Date.now();
    if (now - lastPing < 10000) return; 
    lastPing = now;
    fetch("/ping").catch(() => {});
}

function resetTimers() {
    clearTimeout(pingTimeout);
    clearTimeout(logoutTimer);
    clearTimeout(warningTimer);
    clearInterval(countdownTimer);

    warningBox.style.display = "none"; // üü° hide warning if active again

    sendPing();
    pingTimeout = setTimeout(sendPing, 60 * 1000);

    // Show warning 30s before logout
    warningTimer = setTimeout(() => {
        let remaining = 30;
        warningBox.style.display = "block";
        countdownEl.textContent = remaining;

        countdownTimer = setInterval(() => {
            remaining--;
            countdownEl.textContent = remaining;
            if (remaining <= 0) {
                clearInterval(countdownTimer);
            }
        }, 1000);
    }, INACTIVITY_LIMIT - WARNING_BEFORE_LOGOUT);

    // Auto logout
    logoutTimer = setTimeout(() => {
        fetch("/logout", { method: "POST" })
          .then(() => window.location.href = "/");
    }, INACTIVITY_LIMIT);
}

// Events
["mousemove", "keydown", "scroll", "click", "touchstart"].forEach(evt => {
    document.addEventListener(evt, resetTimers);
});

window.addEventListener("pageshow", sendPing);
window.addEventListener("beforeunload", sendPing);

resetTimers();
</script>

</body>
</html>
