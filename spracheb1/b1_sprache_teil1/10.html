<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Liebe Catherine</title>
  <style>
    /* ========================================= */
    /*        1. MODERN DESIGN TOKENS            */
    /* ========================================= */
    :root {
      /* Palette: Professional Slate & Blue */
      --primary: #1e293b;       /* Royal Blue */
      --primary-soft: #eff6ff;  /* Light Blue bg */
      --primary-dark: #1e40af;
      
      --bg-body: #f1f5f9;       /* Light Gray-Blue */
      --surface: #ffffff;       /* Pure White */
      
      --text-main: #0f172a;     /* Dark Slate */
      --text-body: #334155;     /* Medium Slate */
      --text-muted: #64748b;    /* Light Slate */
      
      --success: #10b945;       /* Emerald */
      --success-bg: #279b57;
      --error: #d30808;         /* Red */
      --error-bg: #cf3d3d;

      /* Spacing & Borders */
      --radius: 12px;
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --border: 1px solid #e2e8f0;
    }

    *, *::before, *::after { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

    /* ========================================= */
    /*           2. BASE LAYOUT                  */
    /* ========================================= */
    body {
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      margin: 0;
      padding: 0;
      background-color: var(--bg-body);
      color: var(--text-main);
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .container {
      flex: 1;
      display: flex;
      flex-direction: column;
      max-width: 1600px;
      width: 100%;
      margin: 0 auto;
      overflow: hidden; /* Lock outer container on desktop */
      padding: 20px;
    }

    .columns {
      display: flex;
      flex-direction: row;
      gap: 30px;
      height: 100%; /* Fill available space */
      overflow: hidden;
    }

    /* ========================================= */
    /*        3. LEFT COLUMN (TEXT)              */
    /* ========================================= */
    .letter {
      flex: 1; /* 50% width */
      background-color: var(--surface);
      padding: 40px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border: var(--border);
      border-top: 5px solid var(--primary);
      
      /* Typography */
      font-size: 1.05rem;
      line-height: 1.8;
      color: var(--text-body);
      
      /* Internal Scrolling for Desktop */
      overflow-y: auto;
      scrollbar-width: thin;
      scrollbar-color: #cbd5e1 transparent;
    }

    .letter p { margin-bottom: 20px; }

    /* The Gaps in text */
    .blank {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 32px;
      height: 26px;
      margin: 0 4px;
      padding: 0 6px;
      background-color: var(--primary-soft);
      color: var(--primary);
      border: 1px solid var(--primary);
      border-radius: 6px;
      font-weight: 700;
      font-size: 0.9rem;
      cursor: default;
      vertical-align: middle;
    }

    /* ========================================= */
    /*       4. RIGHT COLUMN (QUESTIONS)         */
    /* ========================================= */
    .choices {
      flex: 1; /* 50% width */
      display: flex;
      flex-direction: column;
      gap: 16px;
      
      /* Internal Scrolling for Desktop */
      overflow-y: auto;
      padding: 5px; /* prevent shadow clip */
      scrollbar-width: thin;
      scrollbar-color: #cbd5e1 transparent;
    }

    .question-block {
      background: var(--surface);
      padding: 20px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border: var(--border);
      display: flex;
      flex-direction: column;
      gap: 12px;
      transition: transform 0.2s ease;
    }

    .question-block:hover {
      transform: translateY(-2px);
      border-color: #cbd5e1;
    }

    /* Question Number Header */
    .question-block div strong {
      display: inline-block;
      background: var(--text-main);
      color: white;
      width: 28px;
      height: 28px;
      text-align: center;
      line-height: 28px;
      border-radius: 50%;
      font-size: 0.9rem;
      margin-bottom: 5px;
    }

    /* Options Layout */
    .row-container { width: 100%; }
    .options {
      display: flex;
      gap: 10px;
      width: 100%;
    }

    /* ========================================= */
    /*           5. INTERACTIVE OPTIONS          */
    /* ========================================= */
    .option {
      flex: 1;
      text-align: center;
      padding: 12px 5px;
      background-color: #ffffff;
      border: 1px solid #cbd5e1;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 500;
      color: var(--text-main);
      cursor: pointer;
      transition: all 0.2s ease;
      user-select: none;
    }

    .option:hover {
      background-color: #f8fafc;
      border-color: #94a3b8;
    }

    /* States */
    .option.selected {
      background-color: var(--primary);
      color: white;
      border-color: var(--primary);
      box-shadow: 0 4px 10px rgba(37, 99, 235, 0.3);
    }

    .option.correct {
      background-color: var(--success-bg) !important;
      border-color: var(--success) !important;
      color: #ffffff !important;
      font-weight: 700;
    }

    .option.incorrect {
      background-color: var(--error-bg) !important;
      border-color: var(--error) !important;
      color: #ffffff !important;
      opacity: 0.8;
    }

    input[type="radio"] { display: none; }

    /* ========================================= */
    /*              6. BUTTONS                   */
    /* ========================================= */
    .button-wrapper {
      display: flex;
      justify-content: center;
      gap: 15px;
      padding: 20px 25px;
      background: var(--bg-body); /* Blend with background */
      margin-top: auto;
    }

    button, .button-wrapper a {
      padding: 14px 28px;
      font-size: 1rem;
      font-weight: 700;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      text-decoration: none;
      transition: all 0.2s;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 160px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.05);
    }

    #checkBtn {
      background-color: var(--primary);
      color: white;
    }
    #checkBtn:hover {
      background-color: var(--primary-dark);
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(37, 99, 235, 0.25);
    }

    #resetBtn, #homeBtn {
      background-color: white;
      color: var(--text-main);
      border: 1px solid #cbd5e1;
    }
    #resetBtn:hover, #homeBtn:hover {
      background-color: #e2e8f0;
    }

    #warningBox {
      display: none; position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
      background: var(--error); color: white; padding: 12px 24px; border-radius: 8px;
      box-shadow: 0 10px 20px rgba(0,0,0,0.15); font-weight: bold; z-index: 9999;
    }

    /* ========================================= */
    /*           7. MOBILE RESPONSIVE            */
    /* ========================================= */
    @media (max-width: 991px) {
      body {
        height: auto; /* Unlock body height */
        overflow-y: auto; /* Allow natural scrolling */
        display: block;
      }

      .container {
        padding: 15px;
        overflow: visible;
        height: auto;
      }

      .columns {
        flex-direction: column; /* Stack vertically */
        height: auto;
        overflow: visible;
        gap: 20px;
      }

      /* Text Section on Mobile */
      .letter {
        width: 100%;
        height: auto; /* Auto height to show full text */
        max-height: none; /* No scrollbar limitation */
        overflow: visible;
        padding: 25px;
        font-size: 1.1rem; /* Slightly larger for reading */
      }

      /* Questions Section on Mobile */
      .choices {
        width: 100%;
        height: auto;
        overflow: visible;
      }

      .question-block {
        padding: 15px;
      }

      .options { gap: 8px; }
      .option { padding: 12px 5px; font-size: 0.95rem; }

      /* Buttons */
      .button-wrapper {
        flex-direction: column;
        padding-bottom: 40px;
        position: relative;
        margin-top: 20px;
      }
      button, .button-wrapper a { width: 100%; }
    }
  </style>
</head>
<body>

<div class="container">
  <div class="columns">
    <div class="letter">
      <p>Liebe Catherine,</p>
      <p>seit ich dir letzte Mal von meinem Sprachhaufenhalt in der Schweiz <span class="blank" id="blank1">1</span> habe, ist viel passiert. Ich kenne <span class="blank" id="blank2">2</span> Land jetzt schon recht gut. Die Schweiz ist ja wirklich nicht gro√ü. <span class="blank" id="blank3">3</span> in jeder Gegend wird ein anderer Dialekt oder gar eine andere Sprache gesprochen. </p>
      <p>Das ist <span class="blank" id="blank4">4</span> mich fast unglaublich! Bei uns in Australien f√§hrt man mit dem Auto 24 Stunden lang geradeaus, und <span class="blank" id="blank5">5</span> man ankommt, dann sprechen die Leute dort immer noch dieselbe Sprache. Am Anfang hat mich das Sprachgemisch <span class="blank" id="blank6">6</span> sehr verwirrt , aber <span class="blank" id="blank7">7</span> verstehe ich fast alles, wenn jemand auf Schweizerdeutsch zu mir spricht. Ich kann aber nur auf Hochdeutsch antworten.</p>
      <p>Zwischen der Schule hier und unserem Schulsystem in Australien gibt es einige <span class="blank" id="blank8">8</span> : In der Schweiz sprechen die Lehrer viel und die Sch√ºler <span class="blank" id="blank9">9</span> Vieles im Kopf behalten oder aufschreiben. In Australien arbeiten wir meistens im Rahmen von Projekten und machen eigentlich alle Aufgaben auf <span class="blank" id="blank10">10</span> Computer.</p>
      <p>Viele Gr√º√üe</p>
      <p>Jack</p>
    </div>

    <div class="choices">
      <!-- All 10 questions -->
      <div class="question-block" data-blank="1">
        <div><strong>1.</strong></div>
        <div class="row-container">
          <div class="options">
            <label class="option"><input type="radio" name="q1" value="erz√§hle">erz√§hle</label>
            <label class="option"><input type="radio" name="q1" value="erz√§hlen">erz√§hlen</label>
            <label class="option"><input type="radio" name="q1" value="erz√§hlt">erz√§hlt</label>
          </div>
        </div>
      </div>

      <div class="question-block" data-blank="2">
        <div><strong>2.</strong></div>
        <div class="row-container">
          <div class="options">
            <label class="option"><input type="radio" name="q2" value="diese">diese</label>
            <label class="option"><input type="radio" name="q2" value="diesen">diesen</label>
            <label class="option"><input type="radio" name="q2" value="dieses">dieses</label>
          </div>
        </div>
      </div>

      <div class="question-block" data-blank="3">
        <div><strong>3.</strong></div>
        <div class="row-container">
          <div class="options">
            <label class="option"><input type="radio" name="q3" value="aber">aber</label>
            <label class="option"><input type="radio" name="q3" value="obwohl">obwohl</label>
            <label class="option"><input type="radio" name="q3" value="sondern">sondern</label>
          </div>
        </div>
      </div>

      <div class="question-block" data-blank="4">
        <div><strong>4.</strong></div>
        <div class="row-container">
          <div class="options">
            <label class="option"><input type="radio" name="q4" value="an">an</label>
            <label class="option"><input type="radio" name="q4" value="f√ºr">f√ºr</label>
            <label class="option"><input type="radio" name="q4" value="vor">vor</label>
          </div>
        </div>
      </div>

      <div class="question-block" data-blank="5">
        <div><strong>5.</strong></div>
        <div class="row-container">
          <div class="options">
            <label class="option"><input type="radio" name="q5" value="als">als</label>
            <label class="option"><input type="radio" name="q5" value="wann">wann</label>
            <label class="option"><input type="radio" name="q5" value="wenn">wenn</label>
          </div>
        </div>
      </div>

      <div class="question-block" data-blank="6">
        <div><strong>6.</strong></div>
        <div class="row-container">
          <div class="options">
            <label class="option"><input type="radio" name="q6" value="denn">denn</label>
            <label class="option"><input type="radio" name="q6" value="ganz">ganz</label>
            <label class="option"><input type="radio" name="q6" value="schon">schon</label>
          </div>
        </div>
      </div>

      <div class="question-block" data-blank="7">
        <div><strong>7.</strong></div>
        <div class="row-container">
          <div class="options">
            <label class="option"><input type="radio" name="q7" value="fr√ºher">fr√ºher</label>
            <label class="option"><input type="radio" name="q7" value="jetzt">jetzt</label>
            <label class="option"><input type="radio" name="q7" value="seit">seit</label>
          </div>
        </div>
      </div>

      <div class="question-block" data-blank="8">
        <div><strong>8.</strong></div>
        <div class="row-container">
          <div class="options">
            <label class="option"><input type="radio" name="q8" value="Unterschied">Unterschied</label>
            <label class="option"><input type="radio" name="q8" value="Unterschiede">Unterschiede</label>
            <label class="option"><input type="radio" name="q8" value="Unterschieden">Unterschieden</label>
          </div>
        </div>
      </div>

      <div class="question-block" data-blank="9">
        <div><strong>9.</strong></div>
        <div class="row-container">
          <div class="options">
            <label class="option"><input type="radio" name="q9" value="brauchen">brauchen</label>
            <label class="option"><input type="radio" name="q9" value="haben">haben</label>
            <label class="option"><input type="radio" name="q9" value="m√ºssen">m√ºssen</label>
          </div>
        </div>
      </div>

      <div class="question-block" data-blank="10">
        <div><strong>10.</strong></div>
        <div class="row-container">
          <div class="options">
            <label class="option"><input type="radio" name="q10" value="dem">dem</label>
            <label class="option"><input type="radio" name="q10" value="den">den</label>
            <label class="option"><input type="radio" name="q10" value="der">der</label>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="button-wrapper">
  <button id="checkBtn">Antworten pr√ºfen</button>
  <button id="resetBtn">Zur√ºcksetzen</button>
  <a href="/b1_exam.html" id="homeBtn">Zur√ºck zur Startseite</a>
</div>

<script>
  const correctAnswers = {
    1: "erz√§hlt",
    2: "dieses",
    3: "aber",
    4: "f√ºr",
    5: "wenn",
    6: "schon",
    7: "jetzt",
    8: "Unterschiede",
    9: "m√ºssen",
    10: "dem"
  };

  document.querySelectorAll('.option input[type="radio"]').forEach(input => {
    input.addEventListener('change', (e) => {
      const label = e.target.closest('label');
      const block = e.target.closest('.question-block');
      const blankId = block.getAttribute('data-blank');
      const blank = document.getElementById('blank' + blankId);
      block.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
      label.classList.add('selected');
      blank.textContent = e.target.value;
    });
  });

  document.getElementById("checkBtn").addEventListener("click", () => {
    document.querySelectorAll('.question-block').forEach(block => {
      const blankId = block.getAttribute('data-blank');
      const selectedInput = block.querySelector('input[type="radio"]:checked');
      const options = block.querySelectorAll('.option');
      options.forEach(opt => opt.classList.remove('correct', 'incorrect'));
      if (selectedInput) {
        const value = selectedInput.value;
        const label = selectedInput.closest('.option');
        if (value === correctAnswers[blankId]) {
          label.classList.add('correct');
        } else {
          label.classList.add('incorrect');
          options.forEach(opt => {
            if (opt.textContent.trim() === correctAnswers[blankId]) {
              opt.classList.add('correct');
            }
          });
        }
      }
    });
  });

  document.getElementById("resetBtn").addEventListener("click", () => {
    document.querySelectorAll('input[type="radio"]').forEach(input => input.checked = false);
    for (let i = 1; i <= 10; i++) {
      const blank = document.getElementById('blank' + i);
      if (blank) blank.textContent = i;
    }
    document.querySelectorAll('.option').forEach(option => {
      option.classList.remove('selected', 'correct', 'incorrect');
    });
  });
</script>
<script>
let pingTimeout;
let logoutTimer;
let warningTimer;
let countdownTimer;
let lastPing = 0;

const INACTIVITY_LIMIT = 15 * 60 * 1000; // 15 minutes
const WARNING_BEFORE_LOGOUT = 30 * 1000; // 30 seconds
const warningBox = document.getElementById("warningBox");
const countdownEl = document.getElementById("countdown");

function sendPing() {
    const now = Date.now();
    if (now - lastPing < 10000) return; 
    lastPing = now;
    fetch("/ping").catch(() => {});
}

function resetTimers() {
    clearTimeout(pingTimeout);
    clearTimeout(logoutTimer);
    clearTimeout(warningTimer);
    clearInterval(countdownTimer);

    warningBox.style.display = "none"; // üü° hide warning if active again

    sendPing();
    pingTimeout = setTimeout(sendPing, 60 * 1000);

    // Show warning 30s before logout
    warningTimer = setTimeout(() => {
        let remaining = 30;
        warningBox.style.display = "block";
        countdownEl.textContent = remaining;

        countdownTimer = setInterval(() => {
            remaining--;
            countdownEl.textContent = remaining;
            if (remaining <= 0) {
                clearInterval(countdownTimer);
            }
        }, 1000);
    }, INACTIVITY_LIMIT - WARNING_BEFORE_LOGOUT);

    // Auto logout
    logoutTimer = setTimeout(() => {
        fetch("/logout", { method: "POST" })
          .then(() => window.location.href = "/");
    }, INACTIVITY_LIMIT);
}

// Events
["mousemove", "keydown", "scroll", "click", "touchstart"].forEach(evt => {
    document.addEventListener(evt, resetTimers);
});

window.addEventListener("pageshow", sendPing);
window.addEventListener("beforeunload", sendPing);

resetTimers();
</script>

</body>
</html>