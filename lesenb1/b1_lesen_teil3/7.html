<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Lesen Teil 3</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Font Awesome for Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* ========================================= */
    /*        1. PROFESSIONAL VARIABLES          */
    /* ========================================= */
    :root {
      /* Palette */
      --primary: #1e293b;       
      --primary-soft: #e0e7ff;
      --bg-body: #f8fafc;       
      --surface: #ffffff;
      
      --text-main: #0f172a;     
      --text-muted: #64748b;    
      
      --success: #10b981;
      --success-bg: #ecfdf5;
      --error: #ef4444;
      --error-bg: #fef2f2;

      /* Dimensions */
      --radius: 12px;
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      
      --header-height: 60px;
      /* INCREASED HEIGHT FOR MOBILE SLIDER */
      --mobile-answer-height: 170px; 
    }

    *, *::before, *::after { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

    body {
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      margin: 0;
      padding: 0;
      background-color: var(--bg-body);
      color: var(--text-main);
      min-height: 100vh;
      line-height: 1.5;
    }

    /* ========================================= */
    /*           2. HEADER (FIXED)               */
    /* ========================================= */
    .header {
      position: fixed;
      top: 0; left: 0; width: 100%;
      height: var(--header-height);
      background: var(--primary);
      border-bottom: 1px solid rgba(0,0,0,0.08);
      color: var(--surface);
      z-index: 2000;
      display: flex; align-items: center; justify-content: center;
      font-weight: 800; font-size: 1.2rem;
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
      margin: 0;
    }

    /* ========================================= */
    /*           3. LAYOUT CONTAINER             */
    /* ========================================= */
    .container {
      max-width: 1280px;
      margin: 0 auto;
      padding-top: calc(var(--header-height) + 30px);
      padding-bottom: 60px;
      padding-left: 20px; padding-right: 20px;
      display: flex;
      gap: 30px;
      align-items: flex-start;
    }

    /* ========================================= */
    /*        4. LEFT COLUMN (QUESTIONS)         */
    /* ========================================= */
    .left-column {
      width: 65%;
      flex-shrink: 0;
    }

    .quiz-scroll-container {
      background: transparent;
      padding: 0;
      box-shadow: none;
      max-height: none;
      overflow: visible;
    }

    .question-box {
      background: var(--surface);
      border-radius: var(--radius);
      padding: 25px;
      margin-bottom: 24px;
      box-shadow: var(--shadow);
      border: 1px solid #e2e8f0;
      border-left: 5px solid var(--primary);
    }

    .question-text {
      font-size: 1rem;
      color: #334155;
      margin-top: 15px;
    }
    
    .question-text h4 { margin-top: 0; color: var(--primary); margin-bottom: 8px; }

    /* DROP ZONES */
    .drop-target {
      background-color: #f1f5f9;
      border: 2px dashed #cbd5e1;
      border-radius: 10px;
      min-height: 60px;
      display: flex; align-items: center; justify-content: center;
      transition: all 0.2s;
      cursor: pointer;
      position: relative;
      margin-bottom: 15px;
    }

    .drop-target.empty-drop-target::before {
      content: "Hier Antwort ablegen";
      color: #94a3b8; font-size: 0.9rem; font-weight: 500;
      pointer-events: none;
    }

    .drop-target.drag-over {
      background-color: var(--primary-soft);
      border-color: var(--primary);
      transform: scale(1.01);
    }

    /* DROPPED ITEMS */
    .drop-target .draggable {
      background: transparent; border: none; box-shadow: none;
      width: 100%; margin: 0; padding: 5px;
      text-align: center; color: var(--primary); font-weight: 700;
      flex-direction: column;
    }

    /* ========================================= */
    /*        5. RIGHT COLUMN (ANSWERS)          */
    /* ========================================= */
    .right-column {
      width: 30%;
      position: sticky; 
      top: calc(var(--header-height) + 20px); 
      height: calc(100vh - 100px);
      z-index: 1000;
    }

    .right-column-content {
      background: var(--surface);
      padding: 15px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border: 1px solid #e2e8f0;
      max-height: 100%;
      overflow-y: auto;
    }

    /* DRAGGABLE CARDS */
    .draggable {
      background: white;
      border: 1px solid #e2e8f0;
      padding: 12px 15px;
      margin-bottom: 10px;
      border-radius: 8px;
      cursor: grab;
      font-size: 0.9rem; font-weight: 500; color: #334155;
      box-shadow: 0 1px 2px rgba(0,0,0,0.04);
      display: flex; align-items: flex-start; gap: 10px;
      user-select: none;
    }

    .draggable.selected {
      background-color: var(--primary);
      color: white;
      border-color: var(--primary);
    }

    /* CHECKBOX Styling */
    .wrong-flag {
      width: 18px; height: 18px;
      margin-top: 3px;
      flex-shrink: 0;
      cursor: pointer;
      accent-color: var(--error);
    }

    /* ========================================= */
    /*        6. FEEDBACK & BUTTONS              */
    /* ========================================= */
    .drop-target.correct { background: var(--success-bg) !important; border-color: var(--success) !important; }
    .drop-target.correct .draggable { color: #065f46 !important; }
    .drop-target.incorrect { background: var(--error-bg) !important; border-color: var(--error) !important; }
    .drop-target.incorrect .draggable { color: #991b1b !important; }

    /* Buttons */
    .button-container { display: flex; justify-content: center; gap: 15px; margin-top: 40px; margin-bottom: 40px;}
    
    .quiz-button {
      background: var(--text-main); color: white;
      padding: 14px 28px; border-radius: 50px;
      font-weight: 600; border: none; cursor: pointer;
      display: flex; align-items: center; gap: 8px; font-size: 1rem;
      transition: all 0.2s;
      box-shadow: var(--shadow);
      text-decoration: none;
    }
    
    .quiz-button.secondary {
      background: white; color: var(--text-main); border: 1px solid #cbd5e1;
    }

    #result { text-align: center; margin-top: 20px; font-weight: bold; padding: 20px; background: white; border-radius: var(--radius); box-shadow: var(--shadow); }

    /* ========================================= */
    /*           7. MOBILE RESPONSIVE            */
    /* ========================================= */
    @media (max-width: 991px) {
      
      .header { font-size: 1rem; padding: 0 10px; }

      .container {
        flex-direction: column;
        padding: 0;
        /* Padding Top = Header + Bigger AnswerBar + Gap */
        padding-top: calc(var(--header-height) + var(--mobile-answer-height) + 25px);
      }

      /* 1. ANSWER BAR (FIXED TOP HORIZONTAL SLIDER) */
      .right-column {
        position: fixed;
        top: var(--header-height);
        left: 0; width: 100%;
        height: var(--mobile-answer-height);
        z-index: 1500;
        
        background: #f8fafc; /* Match body bg */
        border-bottom: 1px solid rgba(0,0,0,0.1);
        box-shadow: 0 4px 10px -2px rgba(0,0,0,0.05);
      }

      .right-column-content {
        display: flex; 
        flex-direction: row; 
        gap: 12px;
        /* Increased padding inside the slider to prevent clipping */
        padding: 15px 15px;
        
        height: 100%; width: 100%;
        background: transparent;
        border: none; box-shadow: none; border-radius: 0;
        
        overflow-x: auto; 
        overflow-y: hidden;
        white-space: normal;
        scroll-snap-type: x mandatory;
        align-items: center; /* Center vertically */
      }
      .right-column-content::-webkit-scrollbar { display: none; }

      /* Mobile Draggable Cards */
      .draggable {
        flex: 0 0 auto;
        width: 250px; /* Slightly wider */
        height: calc(100% - 10px); /* Leave room for shadow */
        margin: 0;
        
        display: flex; 
        align-items: flex-start; /* Align text top */
        justify-content: center; 
        text-align: left;
        
        font-size: 0.8rem;
        padding: 10px;
        scroll-snap-align: center;
        border: 1px solid #e2e8f0;
        background: white;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      }
      
      .draggable input.wrong-flag {
          margin-top: 2px; /* Fix checkbox alignment */
      }

      /* 2. Questions */
      .left-column { width: 100%; padding: 0 15px; }
      .question-box { padding: 20px; }

      /* 3. Buttons */
      .button-container { flex-direction: column; padding: 0 15px; gap: 10px; }
      .quiz-button { width: 100%; justify-content: center; }
    }
  </style>
</head>
<body>

  <div class="header">Lesen Teil 3:</div>

<div class="container">
  <div class="left-column">
    <div class="quiz-scroll-container">
      <!-- Questions  A-->
      <div class="question-box" data-correct="__NO_CORRECT_ANSWER__" style="text-align: center;">
    <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
    <div class="question-text" style="margin: 0 auto; max-width: 80%;"> 
        <h2>PLANA BADELAND</h2>
        <h3>Mehr Bad f√ºr weniger Geld!</h3>
        <p>Bei PLANA Badeland bekommen Sie immer mehr als<br>
           Sie erwarten: mehr Beratung, mehr Service und mehr<br>
           Bad f√ºrs Geld. So werden aus B√§dern echte Traumb√§der,<br>
           die nicht gleich die Welt kosten.</p>
        <p>√úber 100 Badideen auf 1000qm Ausstellungsfl√§sche.<br>
            Mo-Sa. 10.00-19.00 Uhr.<br>
            So. 10.00-14.00 Uhr</p> 
        <p>Hanauer Stra√üe 56, 69720 Frankfurt<br>
            Tel: 069/ 1431 49-0<br>
            www.plana.de</p> 
        <h5>Achtung: Unser PLANA K√ºchenland ist derzeit<br>
            wegen Umhaus geschlossen! </h5>        
    </div>

      </div><!-- Questions B-->
      <div class="question-box" data-correct="Ihr Kind hat in Mathematik schlechte Noten bekommen und braucht Nachhilfe." style="text-align: center;">
    <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
    <div class="question-text" style="margin: 0 auto; max-width: 80%;"> <!-- Adjust width as needed -->
        <h1>Lernstudio Barbarossa</h1>
        <h2>NACHHILFE &<br>
            HAUSAUFGABEN-<br>
            BETREUUNG</h2>
        <p>- von der Grundschule bis zum Abitur<br>
           -kostenloser Probeunterricht</p> 
        <p>Wolfssucht 19 (Eingang Theaterstra√üe)<br>
           Tel: 0561/76679 94<br>
           Lernstudio Barbarossa</p>
        <h4>Beratung</h4>
        <h5>Mo.-Do. 9-12 und 14-19 Uhr.<br>
            Freitag 14-19 Uhr</h5>
    </div>
      </div><!-- Questions C-->
      <div class="question-box" data-correct="__NO_CORRECT_ANSWER__" style="text-align: center;">
    <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
    <div class="question-text" style="margin: 0 auto; max-width: 80%;"> <!-- Adjust width as needed -->
        <h1>NAKORN</h1>
        <h4>Thai Restaurant</h4>
        <p>Sieben Jahre <br>
            Original Thail√§ndische K√ºche sind f√ºr uns<br>
            ein Grund zu feiern auf alle Gerichte<br>
            20% Rabatt</p>
        <h5>*bei Barzahlung ‚Äì keine Kreditkarten*</h5>
        <h3>Neu!!!</h3>
        <p>Jeden Sonntag Brunch pro Person<br>
            nur Euro 9.-<br>
            Wilhemsh√∂her Allee 42 - Kassel</p>
        <p>Tel (0561) 10 49 28<br>
            Dienstag-Sonntags,<br>
            12.00 - 22.00 Uhr ge√∂ffnet</p>                    
    </div>
      </div><!-- Questions D-->
      <div class="question-box" data-correct="F√ºr Ihre Geburtstagfeier suchen Sie jemanden, der bei Ihnen zu Hause kocht." style="text-align: center;">
    <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
    <div class="question-text" style="margin: 0 auto; max-width: 80%;"> <!-- Adjust width as needed -->
        <h1>Sopha`s Thai-Gormet</h1> 
        <h4>Kassels exotischer Partyservice</h4>
        <p>Ab 10 Men√ºs Lieferung in beheizten<br>
            Silber-Woks, Catering und Fingerfood.<br>
            Wir kochen auch bei Ihnen unsere original<br>
            Thai-Gerichte!<br>
            Wir faxen unsere Men√º- und Speisekarten</p> 
        <p>Tel: 0561/802971<br>
            Fax: 0564/466171<br>
            www.thai-partyservice.de</p>        
    </div>
      </div><!-- Questions E-->
      <div class="question-box" data-correct="Am Samstag wollen sie mit Ihrer Tante eine Blumenausstellung besuchen." style="text-align: center;">
    <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
    <div class="question-text" style="margin: 0 auto; max-width: 80%;"> <!-- Adjust width as needed -->
        <h1>BUGA</h1>
        <p>Vom 28.4. bis 9.10. sind die Pforten der<br>
           Bundesgartenschau f√ºr Besucher ge√∂ffnet.<br>
           200 Hektar Landschaftspark und ca. 2 Millionen-<br>
           Blumen - das und noch mehr hat die <br>
           BUGA zu bieten</p>
        <p>Besuchen Sie auch unsere<br>
            Ausstellungshallen, z.B. das Orchideen-Haus.</p>   
        <h4>Ge√∂ffnet t√§gl. 9.00-20.00 Uhr<br>
            Tageskarten: Erw. 14,-Euro,<br>
            Kinder bis 12. J. 7,-Euro,<br>
            spezielles Abendticket. ab 17.00 Uhr 7,-Euro</h4>
        <h5>www.buga.de</h5>          
    </div>
      </div><!-- Questions F-->
      <div class="question-box" data-correct="Sie m√∂gen thail√§ndisches Essen und m√∂chten lernen, einige Speisen selbst zu kochen." style="text-align: center;">
    <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
    <div class="question-text" style="margin: 0 auto; max-width: 80%;"> <!-- Adjust width as needed -->  
      <h2>Exotische Pfannengerichte</h2> 
        <p>mit feurigen Gew√ºrzen und erntefrischem<br>
            Gem√ºse kochen wir Gerichte, die schnell zubereitet und<br>
            preiswert sind.<br>
           Thai-Gem√ºsepfanne, Weizen-Curry mit<br>
           Bananen, Blumenkohl und Pilzpfanne <br>
           auf Thail√§ndisch Art.</p>
        <p>Das Essen genie√üen Sie am selben Abend<br>
            mit uns in der Gruppe.</p>  
        <p>Freitagsseminar mit Andrea Passenberg<br>
            Freitag 12.11, 17.00 bis 21.00 Uhr<br>
            18.50 Euro</p> 
        <h3>Volkshochschule Wuppertal</h3>
        <h4>El√§ckerstr. 14<br>
            Tel: 06715-212 64 20</h4>        
    </div>
      </div><!-- Questions G-->
    <div class="question-box" data-correct="Sie m√∂chten im August eine Woche in den Bergen wandern und brauchen eine erfahren Person, die mit Ihnen geht." style="text-align: center;">
    <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
    <div class="question-text" style="margin: 0 auto; max-width: 80%;"> <!-- Adjust width as needed -->
        <h1>Kindervortrag</h1> 
        <p>f√ºr 8 bis 12 j√§hrige Kinder bietet das <br>
            Mathematikum etwas Besonderes:<br>
            An einem Samstag im Monat h√§lt Prof.<br>
            Beutelspacher einen speziellen Vortrag f√ºr Kinder.<br>
            In spielirischer Weise stellt er Themen wie <br>
            Geheimcodes, Zauber der Zahlen, Licht und Schatten<br>
            sowie optische T√§uschungen vor.</p>
        <p>Karten im Vorverkauf.<br>
            Mathematikum Gie√üen, Liebisgstr. B, <br>
            35390 Gie√üen</p> 
        <h5>www.mathematikum.de</h5>                  
    </div>
      </div><!-- Questions H-->
      <div class="question-box" data-correct="__NO_CORRECT_ANSWER__" style="text-align: center;">
    <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
    <div class="question-text" style="margin: 0 auto; max-width: 50%;"> <!-- Adjust width as needed -->
          <h2>Volkhochschule Wuppertal-S√ºd</h2>   
          <p>Blumenzauber Samstagswerkstatt mit Waltraud Maisch</p>
            <h4>Sa 16.10., 10.00-18.00 Uhr</h4>
            <p>Mit Blumen, Bl√§ttern, Fr√ºchten und allem,<br>
                was die Natur zu bieten hat, lernen Sie Ihren<br>
                pers√∂nlichen Blumenschmuck herzustellen,<br>
                verschiedene Kompositions-technicken, Kreatives<br>
                Arbeiten - das richtige Geschenk f√ºr jede Gelegenheit</p>  
            <h4>VHS Wuppertal-S√ºd<br>
                Max-Reinhardt-Weg 29<br>
                497285 Wuppertal</h4>     
    </div>
      </div><!-- Questions I-->
      <div class="question-box" data-correct="Ihre Freundin hat Geburtstag. Sie m√∂chten ihr einen Blumenstrau√ü schicken lassen." style="text-align: center;">
    <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
    <div class="question-text" style="margin: 0 auto; max-width: 80%;"> <!-- Adjust width as needed -->
        <h1>Viehmannn</h1>
        <p>Ihr Partner f√ºr moderne Floristik Blumen,<br>
            Pflanzen, Str√§uscher, Rosen in allen Farben<br>
            Hochzeitsschmuck<br>
            B√ºro-, Messe- und Ausstellungsdekoration<br>
            Lieferservice</p>   
        <h4>Viehmann - Floristikfachgesch√§ft<br>
            Wartekuppe 3<br>
            693961 Frankfurt<br>
            Telefon 0696-41 2404</h4>
    </div>
      </div><!-- Questions J-->
      <div class="question-box" data-correct="Sie wollen sich √ºber Wohnwagen informieren." style="text-align: center;">
    <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
    <div class="question-text" style="margin: 0 auto; max-width: 80%;"> <!-- Adjust width as needed -->
        <h1>K U N O ¬¥ S</h1>
        <h3>Mobile Freizeit</h3>
        <p>Reisemobile vom Kleinwohnwagen bis zur<br>
            Luxusausf√ºhrung. Zubeh√∂r, alles auf √úber<br>
            3000 qm Ausstellungsgel√§nde.<br>
            Fachm√§nnische Beratung.</p>
        <p>Wir laden Sie ein zum FR√úHLINGSFEST mit<br>
            verkaufsoffernen Sonntag am 22./23.3.</p>    
        <h4>34295 Ederm√ºnde/Holzhaussen<br>
            Tel: 0 56 65/68 46<br>
            Direkt an der A49</h4>
    </div>
      </div><!-- Questions K-->
      <div class="question-box" data-correct="Sie m√ºssen umziehen und brauchen jemand, der Ihnen hilft." style="text-align: center;">
    <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
    <div class="question-text" style="margin: 0 auto; max-width: 80%;"> <!-- Adjust width as needed -->
        <h1>HARTMANN & SCHR√ñDER</h1>
        <p>- Zuverl√§ssig und Kompetent<br>
            - Transporter-/Minibus- Verleih f√ºr Ihren<br>
            Umzug.<br>
            - Tagestarife, Wochentarife, Wochenendpauschale.<br>
            - Zus√§tsliches Angebot : 2 starke M√§nner plus<br>
            Lkw 48,-Euro/Stunde, <br>
            jeder weitere Mann 29,-Euro/Stunde.</p>
        <h4> Bad Vilbeler Str. 83-85,
            378165 Kassel,
            Tel: 05 61/8 4701
        </h4>    
               
    </div>
      </div><!-- Questions L-->
      <div class="question-box" data-correct="Ihr Kollege heiratet. Sie m√∂chten ihm etwas f√ºr die K√ºche schenken." style="text-align: center;">
    <div class="drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)" onclick="clickDrop(this)"></div>
    <div class="question-text" style="margin: 0 auto; max-width: 80%;"> <!-- Adjust width as needed -->
          <h1>WIR ZIEHEN UM -</h1> 
          <h3>profitieren Sie jetzt von unseren<br>
            Angeboten!</h3>
          <p>Traumhafte M√∂bel und Accessoires: <br>
            Porzellan, Lampen, Geschirr, Keramik,<br>
            handgewebte Teppiche, Tisch- und <br>
            Bettw√§sche.</p>
          <h3>M√ñBELZENTRUM OBERWESER</h3>
          <h4>34359 Reinhardshagen<br>
            6000 m Ausstellung<br>
            Tel 0 55 44/3 07</h4>         
    </div>
      </div>
    </div>
  </div>

    <div class="right-column">
    <!-- MODIFIED: Added ondragover and ondrop to make this a droppable area -->
    <div class="right-column-content" onclick="clearSelected()" ondragover="allowDrop(event)" ondrop="dropOnAnswersContainer(event)">
      <!-- Answers -->
      <div class="draggable" draggable="true" id="a1" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
        <input type="checkbox" class="wrong-flag" onclick="event.stopPropagation()"> Sie m√∂gen thail√§ndisches Essen und m√∂chten lernen, einige Speisen selbst zu kochen.
      </div>
      <div class="draggable" draggable="true" id="a2" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
        <input type="checkbox" class="wrong-flag" onclick="event.stopPropagation()"> Sie m√ºssen umziehen und brauchen jemand, der Ihnen hilft. 
      </div>
      <div class="draggable" draggable="true" id="a3" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
        <input type="checkbox" class="wrong-flag" onclick="event.stopPropagation()"> Ihr Kind hat in Mathematik schlechte Noten bekommen und braucht Nachhilfe.
      </div>
      <div class="draggable" draggable="true" id="a4" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
        <input type="checkbox" class="wrong-flag" onclick="event.stopPropagation()"> Ihre Freundin hat Geburtstag. Sie m√∂chten ihr einen Blumenstrau√ü schicken lassen.
      </div>
      <div class="draggable" draggable="true" id="a5" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
        <input type="checkbox" class="wrong-flag" onclick="event.stopPropagation()"> Am Samstag wollen sie mit Ihrer Tante eine Blumenausstellung besuchen.
      </div>
      <div class="draggable" draggable="true" id="a6" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
        <input type="checkbox" class="wrong-flag" onclick="event.stopPropagation()"> Ihr Kollege heiratet. Sie m√∂chten ihm etwas f√ºr die K√ºche schenken.
      </div>
      <div class="draggable" draggable="true" id="a7" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
        <input type="checkbox" class="wrong-flag" onclick="event.stopPropagation()"> Sie wollen f√ºr eine Hochzeit einen Luxuswagen mieten.
      </div>
      <div class="draggable" draggable="true" id="a8" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
        <input type="checkbox" class="wrong-flag" onclick="event.stopPropagation()"> Am n√§chsten Montag m√∂chten Sie mit Ihren Freunden thail√§ndisch essen gehen.
      </div>
      <div class="draggable" draggable="true" id="a9" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
        <input type="checkbox" class="wrong-flag" onclick="event.stopPropagation()"> F√ºr Ihre Geburtstagfeier suchen Sie jemanden, der bei Ihnen zu Hause kocht.
      </div>
      <div class="draggable" draggable="true" id="a10" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
        <input type="checkbox" class="wrong-flag" onclick="event.stopPropagation()"> Sie wollen sich √ºber Wohnwagen informieren.
      </div>
    </div>
  </div>
</div>

<div id="result"></div>
  <div class="button-container">
    <button id="submitQuizButton" class="quiz-button">
      <i class="fas fa-paper-plane"></i> Abschicken
    </button>
    <button id="resetQuizButton" class="quiz-button secondary">
      <i class="fas fa-redo"></i> Zur√ºcksetzen
    </button>
    <!-- Changed to <a> tag for navigation, href to a generic "index.html" or "#" -->
    <a href="/b1_exam.html" id="homeButton" class="quiz-button secondary" role="button">
      <i class="fas fa-home"></i> Startseite
    </a>
  </div>

<script>
  let selectedAnswer = null;
  const rightColumnContent = document.querySelector(".right-column-content");
  const originalAnswerOrder = Array.from(rightColumnContent.querySelectorAll('.draggable')); // Store initial order for reset

  // MODIFIED: allowDrop to correctly identify parent droppable container
  function allowDrop(ev) {
    ev.preventDefault();
    let droppableContainer = ev.target;
    // Traverse up to find the actual droppable container (.drop-target or .right-column-content)
    while (droppableContainer && droppableContainer !== document.body &&
           !droppableContainer.classList.contains("drop-target") &&
           !droppableContainer.classList.contains("right-column-content")) {
        droppableContainer = droppableContainer.parentElement;
    }

    if (droppableContainer && (droppableContainer.classList.contains("drop-target") || droppableContainer.classList.contains("right-column-content"))) {
        droppableContainer.classList.add("drag-over");
    }
  }

  function drag(ev) {
    ev.dataTransfer.setData("text", ev.target.id);
    ev.target.classList.add("dragging");
    // Store the original parent in case the drag is to another drop-target
    // This can be complex if not dropped successfully; let's manage parentage in drop handlers
  }

  // MODIFIED: Original document 'dragleave' listener is kept, but dragend cleanup is more robust.
  document.addEventListener('dragleave', function(event) {
    // This simple version only removes drag-over if event.target is the droppable itself.
    // More complex logic (checking event.relatedTarget) is needed for perfect behavior
    // when dragging over children, but dragend cleanup will handle most cases.
    if (event.target.classList && (event.target.classList.contains("drop-target") || event.target.classList.contains("right-column-content"))) {
        // A basic check: if relatedTarget is outside this element, remove drag-over
        if (!event.target.contains(event.relatedTarget) && event.target !== event.relatedTarget) {
             event.target.classList.remove("drag-over");
        } else if (event.relatedTarget === null) { // Mouse left the window
            event.target.classList.remove("drag-over");
        }
    }
  }, false);
  
  // MODIFIED: dragend to clean up all drag-over classes
  document.addEventListener('dragend', function(event) {
    if (event.target.classList && event.target.classList.contains('draggable')) {
      event.target.classList.remove('dragging');
    }
    // Global cleanup for any remaining drag-over states
    document.querySelectorAll('.drop-target.drag-over, .right-column-content.drag-over').forEach(el => {
        el.classList.remove('drag-over');
    });
  });

  // MODIFIED: drop function for question slots
  function drop(ev) {
    ev.preventDefault();
    const draggedId = ev.dataTransfer.getData("text");
    const draggedEl = document.getElementById(draggedId);
    let dropTarget = ev.target;

    while (dropTarget && !dropTarget.classList.contains("drop-target")) {
        dropTarget = dropTarget.parentElement;
    }
    
    if (!dropTarget || !draggedEl) return;

    dropTarget.classList.remove("drag-over");
    // draggedEl.classList.remove("dragging"); // Done by dragend

    const originalParentOfDraggedEl = draggedEl.parentElement; // Capture before moving

    const currentAnswerInTarget = dropTarget.querySelector(".draggable");
    if (currentAnswerInTarget && currentAnswerInTarget !== draggedEl) {
      rightColumnContent.appendChild(currentAnswerInTarget);
      showCheckbox(currentAnswerInTarget);
      // The targetDropzone (parent of currentAnswerInTarget) will be updated by updateDropTargetState(dropTarget)
    }
    
    dropTarget.innerHTML = ""; // Clear previous content
    dropTarget.appendChild(draggedEl);
    hideCheckbox(draggedEl);
    updateDropTargetState(dropTarget);

    // If the dragged element came from a *different* drop-target, update that one too.
    if (originalParentOfDraggedEl &&
        originalParentOfDraggedEl.classList.contains("drop-target") &&
        originalParentOfDraggedEl !== dropTarget) {
        updateDropTargetState(originalParentOfDraggedEl);
    }

    if (selectedAnswer === draggedEl) {
        draggedEl.classList.remove("selected");
        selectedAnswer = null;
    }
  }

  // NEW: Function to handle drops onto the answers container
  function dropOnAnswersContainer(ev) {
    ev.preventDefault();
    const draggedId = ev.dataTransfer.getData("text");
    const draggedEl = document.getElementById(draggedId);
    const answersContainer = ev.currentTarget; // This is right-column-content

    if (!draggedEl || !answersContainer) return;

    answersContainer.classList.remove("drag-over");
    // draggedEl.classList.remove("dragging"); // Done by dragend

    const originalParentOfDraggedEl = draggedEl.parentElement; // Capture before moving

    answersContainer.appendChild(draggedEl);
    showCheckbox(draggedEl);

    // If the dragged element came from a question's drop-target, update that drop-target's state
    if (originalParentOfDraggedEl && originalParentOfDraggedEl.classList.contains("drop-target")) {
        updateDropTargetState(originalParentOfDraggedEl);
    }

    if (selectedAnswer === draggedEl) {
        draggedEl.classList.remove("selected");
        selectedAnswer = null;
    }
  }


  function hideCheckbox(el) {
    const checkbox = el.querySelector(".wrong-flag");
    if (checkbox) checkbox.style.display = "none";
  }

  function showCheckbox(el) {
    const checkbox = el.querySelector(".wrong-flag");
    if (checkbox) checkbox.style.display = "inline-block";
  }

  function selectAnswer(el, event) {
    event.stopPropagation(); 
    if (selectedAnswer === el) { 
      el.classList.remove("selected");
      selectedAnswer = null;
    } else {
      if (selectedAnswer) selectedAnswer.classList.remove("selected");
      selectedAnswer = el;
      el.classList.add("selected");
    }
  }

  // MODIFIED: clickDrop function
  function clickDrop(targetDropzone) {
    if (selectedAnswer) {
      const originalParentOfSelectedAnswer = selectedAnswer.parentElement; // Capture before moving

      const currentAnswerInDropzone = targetDropzone.querySelector(".draggable");
      if (currentAnswerInDropzone && currentAnswerInDropzone !== selectedAnswer) {
        rightColumnContent.appendChild(currentAnswerInDropzone);
        showCheckbox(currentAnswerInDropzone);
      }
      
      targetDropzone.innerHTML = ""; 
      targetDropzone.appendChild(selectedAnswer);
      hideCheckbox(selectedAnswer);
      updateDropTargetState(targetDropzone);

      // If selectedAnswer came from a *different* drop-target, update that one.
      if (originalParentOfSelectedAnswer &&
          originalParentOfSelectedAnswer.classList.contains("drop-target") &&
          originalParentOfSelectedAnswer !== targetDropzone) {
          updateDropTargetState(originalParentOfSelectedAnswer);
      }
      // If it came from rightColumnContent, originalParentOfSelectedAnswer is rightColumnContent, no UI update needed for it.

      selectedAnswer.classList.remove("selected");
      selectedAnswer = null;
    }
  }

  function clearSelected() {
    if (selectedAnswer) {
      selectedAnswer.classList.remove("selected");
      selectedAnswer = null;
    }
  }

  function updateDropTargetState(dropTarget) {
    if (!dropTarget || !dropTarget.classList.contains('drop-target')) return;
    
    if (dropTarget.querySelector(".draggable")) {
      dropTarget.classList.remove("empty-drop-target");
    } else {
      dropTarget.classList.add("empty-drop-target");
    }
  }

  function getDraggableText(draggableElement) {
    const clone = draggableElement.cloneNode(true);
    const checkbox = clone.querySelector('.wrong-flag');
    if (checkbox) {
        checkbox.remove();
    }
    return clone.textContent.trim();
  }

  function submitQuiz() {
    let total = 0, correct = 0;
    document.querySelectorAll('.question-box').forEach((box) => {
      total++;
      const correctAnswerText = box.getAttribute("data-correct").trim();
      const dropTarget = box.querySelector(".drop-target");
      const droppedDraggable = dropTarget.querySelector(".draggable");
      
      dropTarget.classList.remove("correct", "incorrect"); 

      if (droppedDraggable) { 
        const selectedText = getDraggableText(droppedDraggable); 
        if (correctAnswerText === "__NO_CORRECT_ANSWER__") {
          dropTarget.classList.add("incorrect");
        } else {
          if (selectedText === correctAnswerText) {
            dropTarget.classList.add("correct");
            correct++;
          } else {
            dropTarget.classList.add("incorrect");
          }
        }
      } else { 
        if (correctAnswerText !== "__NO_CORRECT_ANSWER__") {
          dropTarget.classList.add("incorrect");
        }
      }
      updateDropTargetState(dropTarget); 
    });

    let wrongMarkedCorrect = 0, wrongMarkedTotal = 0;
    rightColumnContent.querySelectorAll('.draggable').forEach((answerEl) => {
      const text = getDraggableText(answerEl); 
      const checkbox = answerEl.querySelector('.wrong-flag');
      
      const isACorrectAnswerOptionForAnyQuestion = Array.from(document.querySelectorAll('.question-box'))
        .some(box => {
            const qCorrectText = box.getAttribute('data-correct').trim();
            return qCorrectText !== "__NO_CORRECT_ANSWER__" && qCorrectText === text;
        });
      
      if (!isACorrectAnswerOptionForAnyQuestion) { 
        wrongMarkedTotal++; 
        if (checkbox.checked) {
          wrongMarkedCorrect++; 
        }
      }
    });

    const questionsWithNoAnswer = Array.from(document.querySelectorAll('.question-box'))
                                      .filter(box => box.getAttribute('data-correct').trim() === "__NO_CORRECT_ANSWER__").length;
    const scorableTotal = total - questionsWithNoAnswer;


    const resultDiv = document.getElementById("result");
    resultDiv.innerHTML =
      `<span class="correct-count">‚úÖ ${correct}</span> von <span class="total-count">${scorableTotal}</span> bewertbaren Fragen richtig. | ` + 
      `<span class="marked-wrong-count">üö´ Falsch-Antworten korrekt markiert: ${wrongMarkedCorrect}</span> von ${wrongMarkedTotal}.`;
  }

  function resetQuiz() {
    document.querySelectorAll('.drop-target').forEach(dt => {
        const draggable = dt.querySelector('.draggable');
        if (draggable) {
            // Append to ensure it's at the end if others were returned individually
            rightColumnContent.appendChild(draggable); 
            showCheckbox(draggable); 
        }
        dt.innerHTML = ''; 
        dt.classList.remove('correct', 'incorrect'); 
        updateDropTargetState(dt); 
    });

    // Clear the right column first to avoid duplicates if an item was already returned
    rightColumnContent.innerHTML = ''; 
    originalAnswerOrder.forEach(draggable => {
        rightColumnContent.appendChild(draggable); 
        draggable.classList.remove('selected', 'dragging'); 
        showCheckbox(draggable); 
        const checkbox = draggable.querySelector('.wrong-flag');
        if (checkbox) checkbox.checked = false; 
    });
    
    if (selectedAnswer) {
      selectedAnswer.classList.remove('selected');
      selectedAnswer = null;
    }

    document.getElementById("result").innerHTML = ""; 
  }

  document.getElementById('submitQuizButton').addEventListener('click', submitQuiz);
  document.getElementById('resetQuizButton').addEventListener('click', resetQuiz);

  document.querySelectorAll('.drop-target').forEach(updateDropTargetState);
</script>
<script>
let pingTimeout;
let logoutTimer;
let warningTimer;
let countdownTimer;
let lastPing = 0;

const INACTIVITY_LIMIT = 15 * 60 * 1000; // 15 minutes
const WARNING_BEFORE_LOGOUT = 30 * 1000; // 30 seconds
const warningBox = document.getElementById("warningBox");
const countdownEl = document.getElementById("countdown");

function sendPing() {
    const now = Date.now();
    if (now - lastPing < 10000) return; 
    lastPing = now;
    fetch("/ping").catch(() => {});
}

function resetTimers() {
    clearTimeout(pingTimeout);
    clearTimeout(logoutTimer);
    clearTimeout(warningTimer);
    clearInterval(countdownTimer);

    warningBox.style.display = "none"; // üü° hide warning if active again

    sendPing();
    pingTimeout = setTimeout(sendPing, 60 * 1000);

    // Show warning 30s before logout
    warningTimer = setTimeout(() => {
        let remaining = 30;
        warningBox.style.display = "block";
        countdownEl.textContent = remaining;

        countdownTimer = setInterval(() => {
            remaining--;
            countdownEl.textContent = remaining;
            if (remaining <= 0) {
                clearInterval(countdownTimer);
            }
        }, 1000);
    }, INACTIVITY_LIMIT - WARNING_BEFORE_LOGOUT);

    // Auto logout
    logoutTimer = setTimeout(() => {
        fetch("/logout", { method: "POST" })
          .then(() => window.location.href = "/");
    }, INACTIVITY_LIMIT);
}

// Events
["mousemove", "keydown", "scroll", "click", "touchstart"].forEach(evt => {
    document.addEventListener(evt, resetTimers);
});

window.addEventListener("pageshow", sendPing);
window.addEventListener("beforeunload", sendPing);

resetTimers();
</script>

</body>
</html>